<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting Growth Functions in FSA • FSA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="Fitting_Growth_Functions_files/libs/quarto-html/popper.min.js"></script><script src="Fitting_Growth_Functions_files/libs/quarto-html/tippy.umd.min.js"></script><link href="Fitting_Growth_Functions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Fitting_Growth_Functions_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Growth Functions in FSA">
<meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Computing_PSDs.html">Computing Proportional Size Distribution Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Computing_Relative_Weights.html">Computing Relative Weights</a></li>
    <li><a class="dropdown-item" href="../articles/Fitting_Growth_Functions.html">Fitting Growth Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Growth_Starting_Values.html">Explaining Starting Values for Growth Functions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto FSA home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA" aria-label="Goto FSA github page"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting Growth Functions in FSA</h1>

      <p class="author">Derek H. Ogle</p>
      <p class="date">2025-04-24</p>

      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/dev/vignettes/articles/Fitting_Growth_Functions.qmd" class="external-link"><code>vignettes/articles/Fitting_Growth_Functions.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fishr-core-team.github.io/FSA/">FSA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<p>The objective of this article is to briefly describe how to fit growth functions commonly used in fisheries to data using the <code>FSA</code> package for R. It assumes that you are familiar with fish growth data, fish growth functions, and non-linear modeling. This background is also described in Chapter 12 of my <a href="https://derekogle.com/IFAR/" class="external-link">Introductory Fisheries Analyses with R</a> book, my (and co-authors) Chapter 12 in <a href="https://fisheries.org/bookstore/all-titles/professional-and-trade/55078c/" class="external-link">Age and Growth of Fishes: Principles and Techniques</a> book, and in several <a href="https://fishr-core-team.github.io/fishR/blog/#category=Growth" class="external-link">fishR blog posts</a>.</p>
<p>The main functions from <code>FSA</code> used to model fish growth are <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code> to create R functions that represent various parameterizations of common fisheries growth functions, <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code> to identify typically useful starting values to be used in non-linear algorithms for fitting common fisheries growth models, and <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> for creating strings or expressions of the equations for common fisheries growth function. Each of these functions uses <code>type=</code> to identify a common fisheries growth function family (i.e,. <code>"von Bertalanffy"</code>, “<code>Gomperz</code>”, “<code>logistic</code>”, “<code>Richards</code>”, “<code>Schnute</code>”, or “<code>Schnute-Richards</code>”) and <code>param=</code> or <code>pname=</code> to identify a specific paramaterization of the function within that family, either by number or by name. These and other common arguments to these functions are described and illustrated below. More focused or advanced use is illustrated in the function documentations.</p>
<p>Note that the <code>FSA</code> functions described here were modified after version 0.9.6 and are thus <strong>specific to FSA &gt;v0.9.6</strong>.</p>
<section class="section level2"><h2 id="first-example-typical-von-bertalanffy">First Example – Typical von Bertalanffy<a class="anchor" aria-label="anchor" href="#first-example-typical-von-bertalanffy"></a>
</h2>
<p>The most common growth model is the von Bertalanffy model as parameterized by Beverton and Holt with three paramaters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>∞</mi></msub><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>. The equation for this growth function can be displayed with <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> using <code>type="von Bertalanffy"</code>, <code>pname="Typical"</code>,<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Or &lt;code&gt;param=1&lt;/code&gt;&lt;/p&gt;"><sup>1</sup></a> and, to display the equation, <code>plot=TRUE</code>).<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;code&gt;cex=1.5&lt;/code&gt; is used to make the text larger.&lt;/p&gt;"><sup>2</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"von Bertalanffy"</span>,pname<span class="op">=</span><span class="st">"Typical"</span>,plot<span class="op">=</span><span class="cn">TRUE</span>,cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-1-1.png" class="quarto-figure quarto-figure-center" width="288"></p>
</figure>
</div>
</div>
</div>
<p>An R function to return a predicted length from this equation when given an age (or ages) and values for the three parameters can be created with <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code> using the same <code>type=</code> and <code>pname=</code><a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Or &lt;code&gt;param=&lt;/code&gt;&lt;/p&gt;"><sup>3</sup></a> as used in <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code>. The result from <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code> should be assigned to an object, which will then be the name of the R function to predict lengths.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrowthFun.html">makeGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"von Bertalanffy"</span>,pname<span class="op">=</span><span class="st">"Typical"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>For example, <code>vb1()</code> can now be used to predict the mean length for age-2 fish assuming <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>∞</mi></msub><mo>=</mo><mn>450</mn></mrow><annotation encoding="application/x-tex">L_\infty=450</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">K=0.3</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>=</mo><mi>−</mi><mn>0.5</mn></mrow><annotation encoding="application/x-tex">t_0=-0.5</annotation></semantics></math>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vb1</span><span class="op">(</span><span class="fl">2</span>,Linf<span class="op">=</span><span class="fl">450</span>,K<span class="op">=</span><span class="fl">0.3</span>,t0<span class="op">=</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 237.4351</span></span></code></pre></div>
</div>
<p>The default result from <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code> creates a function where the three parameters can be given to the first parameter name as a numeric vector with values for all three parameters. For example, the mean length at age-2 can also be predicted with the following.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vb1</span><span class="op">(</span><span class="fl">2</span>,Linf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">450</span>,<span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 237.4351</span></span></code></pre></div>
</div>
<p>Note that using the vector of parameter values in this way is useful (as will be demonstrated below) but also requires that the values are provided in the order that the function expects them. This order can be seen by displaying the function code and noting the order of the arguments in the function declaration.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vb1</span></span>
<span><span class="co">#&gt; function (t, Linf, K = NULL, t0 = NULL) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     if (length(Linf) == 3) {</span></span>
<span><span class="co">#&gt;         t0 &lt;- Linf[[3]]</span></span>
<span><span class="co">#&gt;         K &lt;- Linf[[2]]</span></span>
<span><span class="co">#&gt;         Linf &lt;- Linf[[1]]</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     Linf * (1 - exp(-K * (t - t0)))</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55a228c7ef38&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:FSA&gt;</span></span></code></pre></div>
</div>
<p>The same <code>vb1()</code> function can be used to predict mean lengths for a number of ages (e.g., ages 2 to 12 below).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vb1</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">12</span>,Linf<span class="op">=</span><span class="fl">450</span>,K<span class="op">=</span><span class="fl">0.3</span>,t0<span class="op">=</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 237.4351 292.5280 333.3419 363.5775 385.9767 402.5703 414.8633 423.9701</span></span>
<span><span class="co">#&gt;  [9] 430.7165 435.7145 439.4170</span></span></code></pre></div>
</div>
<p>These examples of predicted mean lengths at age given the growth function equation and parameter values are fairly trivial. The most useful aspect of the saved function will be its use in fitting data to the growth function.</p>
<p>Non-linear model fitting algorithms require starting values for the function parameters. Starting values for the parameters of most common fisheries growth functions can be obtained using <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code>. To demonstrate <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code> suppose that length-at-age (recorded as an annual age) are available in <code>tlV</code> and <code>age</code> of the <code>GrowthData1</code> data.frame,<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This data.frame is available in &lt;code&gt;FSA&lt;/code&gt;.&lt;/p&gt;"><sup>4</sup></a>, a snapshot of which is shown below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">GrowthData1</span>,n<span class="op">=</span><span class="fl">10</span>,which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tlV"</span>,<span class="st">"age"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     tlV age</span></span>
<span><span class="co">#&gt; 1    61   0</span></span>
<span><span class="co">#&gt; 20  220   2</span></span>
<span><span class="co">#&gt; 40  245   2</span></span>
<span><span class="co">#&gt; 60  319   3</span></span>
<span><span class="co">#&gt; 80  278   3</span></span>
<span><span class="co">#&gt; 99  341   4</span></span>
<span><span class="co">#&gt; 119 384   5</span></span>
<span><span class="co">#&gt; 139 419   7</span></span>
<span><span class="co">#&gt; 159 462   9</span></span>
<span><span class="co">#&gt; 179 435  15</span></span></code></pre></div>
</div>
<p><code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code> requires a formula of the form <code>length~age</code>,<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This is true for length-at-age models, but will differ for tag-recapture data, which will be shown later.&lt;/p&gt;"><sup>5</sup></a> a corresponding data.frame in <code>data=</code>, and the same <code>type=</code> and <code>pname=</code><a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Or &lt;code&gt;param=&lt;/code&gt;&lt;/p&gt;"><sup>6</sup></a> as in <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> and <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code>. For example, starting values for the <code>GrowthData1</code> data and the typical parameterization of the von Bertalanffy growth function are obtained below. The results of <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code> should be assigned to an object for later use.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The leading and trailing parentheses below force the result to also be shown when it is assigned to an object.&lt;/p&gt;"><sup>7</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">vsv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">tlV</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,type<span class="op">=</span><span class="st">"von Bertalanffy"</span>,pname<span class="op">=</span><span class="st">"Typical"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt;        Linf           K          t0 </span></span>
<span><span class="co">#&gt; 454.4806075   0.2974555  -0.4752262</span></span></code></pre></div>
</div>
<p>There may be times when the provided starting values are non-sensical (you may get a warning message) or they do not lead to model convergence when fitting the non-linear regression to data. In these instances it may be useful to view a quick diagnostic plot of how the model evaluated at the starting values “fits” the data. Such a plot can be made by including <code>plot=TRUE</code> in <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;As a general rule use &lt;code&gt;plot=TRUE&lt;/code&gt; to immediately examine the relative “fit” of the starting values, rather than waiting for an “issue” to appear.&lt;/p&gt;"><sup>8</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vsv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">tlV</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,type<span class="op">=</span><span class="st">"von Bertalanffy"</span>,pname<span class="op">=</span><span class="st">"Typical"</span>,</span>
<span>                         plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Additionally, it may be useful to “fix” some starting values at values of your choice (rather than having them determined from the data). Such parameters can be included in a <strong>NAMED</strong> vector given to <code>fixed=</code> in <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code>. For example, the <code>K</code> parameter is fixed at 0.5 below.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Fixing &lt;math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"&gt;&lt;semantics&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;annotation encoding="application/x-tex"&gt;K&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt; looks inappropriate in this example.&lt;/p&gt;'><sup>9</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vsv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">tlV</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,type<span class="op">=</span><span class="st">"von Bertalanffy"</span>,param<span class="op">=</span><span class="fl">1</span>,</span>
<span>                         fixed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>K<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Data are then fit to the non-linear growth model using <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls()</a></code> with a formula that has <code>length</code> on the left-hand-side and the specific growth function with the specific <code>age</code> variable and model parameter names on the right-hand-side, the associated data in <code>data=</code>, and the saved starting values in <code>start=</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">tlV</span><span class="op">~</span><span class="fu">vb1</span><span class="op">(</span><span class="va">age</span>,<span class="va">Linf</span>,<span class="va">K</span>,<span class="va">t0</span><span class="op">)</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,start<span class="op">=</span><span class="va">vsv1</span><span class="op">)</span></span></code></pre></div>
</div>
<p>The estimated values of the parameters are extracted from this saved <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls()</a></code> object with <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> and likelihood profile confidence intervals are extracted with <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code>. The two can be column-bound together for a concise report.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Est<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resv1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt;              Est        2.5%       97.5%</span></span>
<span><span class="co">#&gt; Linf 456.0374952 448.7004147 463.7915414</span></span>
<span><span class="co">#&gt; K      0.2932701   0.2761202   0.3107616</span></span>
<span><span class="co">#&gt; t0    -0.4848237  -0.5943280  -0.3845776</span></span></code></pre></div>
</div>
<p>Displaying the fitted function with the data can be done in a variety of ways. Below is a quick plot that uses <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code> along with <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function()</a></code>. The important things to note about <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function()</a></code> are that the R function for the growth function is given in <code>fun=</code> and the parameter estimates are extracted with <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code> and given to the first parameter name (i.e,. <code>Linf</code> in this example) inside a list that is assigned to <code>args=</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">GrowthData1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">tlV</span>,x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span>,alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Total Length (mm)"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">vb1</span>,args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Linf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv1</span><span class="op">)</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span>,color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>An equation of the growth function with the parameter estimates can be created with <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> using the same <code>type=</code> and <code>pname=</code> as before, but also including the saved <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls()</a></code> object in <code>fit=</code>. The object returned from <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> can be used in <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate()</a></code> from <code>ggplot2</code> to add the equation to the plot. Note that <code>parse=TRUE</code> is required in <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate()</a></code> to convert the text returned from <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> into an expression, <code>size=</code> controls the size of the text, and <code>x=</code> and <code>y=</code> are used to place (usually with trial-and-error) the equation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">GrowthData1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">tlV</span>,x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span>,alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Total Length (mm)"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">vb1</span>,args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Linf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv1</span><span class="op">)</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span>,color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>,</span>
<span>           label<span class="op">=</span><span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"von Bertalanffy"</span>,pame<span class="op">=</span><span class="st">"Typical"</span>,fit<span class="op">=</span><span class="va">resv1</span><span class="op">)</span>,</span>
<span>           parse<span class="op">=</span><span class="cn">TRUE</span>,size<span class="op">=</span><span class="fl">5</span>,x<span class="op">=</span><span class="fl">9</span>,y<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="second-example-richards">Second Example – Richards<a class="anchor" aria-label="anchor" href="#second-example-richards"></a>
</h2>
<p>The same general process works for other growth models. For example, suppose that your data suggests an inflection point in the growth trajectory so you want to fit the second parameterization of the Richards function, which has four parameters of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>∞</mi></msub><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>. The same general workflow is illustrated below noting that <code>type="Richards"</code> and <code>param=2</code> is used, but those are assigned to objects outside the function to save some repetitive typing.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Also note that the response variable was changed to &lt;code&gt;tlR&lt;/code&gt; as these are lengths in &lt;code&gt;GrowthData1&lt;/code&gt; that exhibited an inflection point.&lt;/p&gt;"><sup>10</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">typ</span> <span class="op">&lt;-</span> <span class="st">"Richards"</span></span>
<span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">rich1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrowthFun.html">makeGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,param<span class="op">=</span><span class="va">prm</span><span class="op">)</span></span>
<span><span class="va">rsv1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">tlR</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,type<span class="op">=</span><span class="va">typ</span>,param<span class="op">=</span><span class="va">prm</span>,plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">tlR</span><span class="op">~</span><span class="fu">rich1</span><span class="op">(</span><span class="va">age</span>,<span class="va">Linf</span>,<span class="va">k</span>,<span class="va">t0</span>,<span class="va">b</span><span class="op">)</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,start<span class="op">=</span><span class="va">rsv1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Est<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resr1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resr1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt;              Est        2.5%       97.5%</span></span>
<span><span class="co">#&gt; Linf 452.9499118 444.5152186 462.5688222</span></span>
<span><span class="co">#&gt; k      0.5309684   0.4303097   0.6601910</span></span>
<span><span class="co">#&gt; t0     4.7527545   3.4644030   5.5695013</span></span>
<span><span class="co">#&gt; b     -0.4424650  -0.7086819  -0.3007673</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">GrowthData1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">tlR</span>,x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span>,alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Total Length (mm)"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">rich1</span>,args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Linf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resr1</span><span class="op">)</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span>,color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>,label<span class="op">=</span><span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,param<span class="op">=</span><span class="va">prm</span>,fit<span class="op">=</span><span class="va">resr1</span><span class="op">)</span>,</span>
<span>           parse<span class="op">=</span><span class="cn">TRUE</span>,size<span class="op">=</span><span class="fl">5</span>,x<span class="op">=</span><span class="fl">9</span>,y<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="third-example-francis-von-bertalanffy">Third Example – Francis von Bertalanffy<a class="anchor" aria-label="anchor" href="#third-example-francis-von-bertalanffy"></a>
</h2>
<p>Some growth models require certain values to be set at constant values. For example, the Francis parameterization of the von Bertalanffy function has three parameters (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>1</mn></msub><annotation encoding="application/x-tex">L_1</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>3</mn></msub><annotation encoding="application/x-tex">L_3</annotation></semantics></math>) that are estimated mean lengths at three specified ages. Two of those ages – <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>3</mn></msub><annotation encoding="application/x-tex">t_3</annotation></semantics></math> – are set by the user for defining <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>1</mn></msub><annotation encoding="application/x-tex">L_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>3</mn></msub><annotation encoding="application/x-tex">L_3</annotation></semantics></math>. The third parameter (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>2</mn></msub><annotation encoding="application/x-tex">L_2</annotation></semantics></math>) is defined at the time that is the average of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>3</mn></msub><annotation encoding="application/x-tex">t_3</annotation></semantics></math>. Ages for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>1</mn></msub><annotation encoding="application/x-tex">t_1</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>3</mn></msub><annotation encoding="application/x-tex">t_3</annotation></semantics></math> must be set in a <strong>NAMED</strong> vector (<code>cv2</code> below) given to <code>constvals=</code> in <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code>, the function created by <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code>, and <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code>. The rest of the workflow is the similar to above (noting that <code>type=</code> and <code>pname=</code> are adjusted). However note that the Francis model uses a “where” clause to simplify the look of the equation, which can result in a long (i.e., wide) equation. The use of <code>stackWhere=TRUE</code> in <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> will “stack” the “where” clause underneath the main equation to narrow (but make taller) the equation. Further note that the result from <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> was saved to an object here just to reduce clutter in the plotting code.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">typ</span> <span class="op">&lt;-</span> <span class="st">"von Bertalanffy"</span></span>
<span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="st">"Francis"</span></span>
<span><span class="va">vb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrowthFun.html">makeGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span><span class="op">)</span></span>
<span><span class="va">cv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>t1<span class="op">=</span><span class="fl">0</span>,t3<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">rsv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">tlV</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span>,</span>
<span>                         constvals<span class="op">=</span><span class="va">cv2</span>,plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">tlV</span><span class="op">~</span><span class="fu">vb2</span><span class="op">(</span><span class="va">age</span>,<span class="va">L1</span>,<span class="va">L2</span>,<span class="va">L3</span>,t1<span class="op">=</span><span class="va">cv2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">GrowthData1</span>,start<span class="op">=</span><span class="va">rsv2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Est<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resv2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt;          Est      2.5%     97.5%</span></span>
<span><span class="co">#&gt; L1  60.44277  50.41095  70.34143</span></span>
<span><span class="co">#&gt; L2 387.95159 385.04537 390.85403</span></span>
<span><span class="co">#&gt; L3 444.31932 438.84385 449.85716</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eqn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span>,fit<span class="op">=</span><span class="va">resv2</span>,constvals<span class="op">=</span><span class="va">cv2</span>,stackWhere<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">GrowthData1</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">tlV</span>,x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span>,alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Total Length (mm)"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">vb2</span>,args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>L1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv2</span><span class="op">)</span>,t1<span class="op">=</span><span class="va">cv2</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span>,color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>,label<span class="op">=</span><span class="va">eqn</span>,parse<span class="op">=</span><span class="cn">TRUE</span>,size<span class="op">=</span><span class="fl">4.5</span>,x<span class="op">=</span><span class="fl">10</span>,y<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="fourth-example-somers-seasonal-von-bertalanffy">Fourth Example – Somer’s (Seasonal) von Bertalanffy<a class="anchor" aria-label="anchor" href="#fourth-example-somers-seasonal-von-bertalanffy"></a>
</h2>
<p>The Somer’s parameterization of the von Bertalanffy can be used to model data where ages are fractional parts of the year, often referred to as seasonal length-at-age data. The process for fitting this model is very similar to above as illustrated below.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Noting that the &lt;code&gt;tlS&lt;/code&gt; from &lt;code&gt;GrowthData2&lt;/code&gt; is used here as is contains a seasonal length-at-age example.&lt;/p&gt;"><sup>11</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"von Bertalanffy"</span></span>
<span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="st">"Somers"</span></span>
<span><span class="va">vb3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrowthFun.html">makeGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span><span class="op">)</span></span>
<span><span class="va">rsv3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">tlS</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">GrowthData2</span>,type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span>,plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-19-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resv3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">tlS</span><span class="op">~</span><span class="fu">vb3</span><span class="op">(</span><span class="va">age</span>,<span class="va">Linf</span>,<span class="va">K</span>,<span class="va">t0</span>,<span class="va">C</span>,<span class="va">ts</span><span class="op">)</span>,data<span class="op">=</span><span class="va">GrowthData2</span>,start<span class="op">=</span><span class="va">rsv3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Est<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resv3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt;              Est         2.5%       97.5%</span></span>
<span><span class="co">#&gt; Linf 450.3311672 446.26959271 454.5753258</span></span>
<span><span class="co">#&gt; K      0.5052008   0.48680724   0.5239582</span></span>
<span><span class="co">#&gt; t0    -0.4183363  -0.55965206  -0.1697775</span></span>
<span><span class="co">#&gt; C      0.9398083   0.73548569   1.1529083</span></span>
<span><span class="co">#&gt; ts     0.1145216   0.07858732   0.1420780</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eqn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span>,fit<span class="op">=</span><span class="va">resv3</span>,stackWhere<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">GrowthData2</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">tlS</span>,x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span>,alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Total Length (mm)"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Age (years)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">vb3</span>,args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Linf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv3</span><span class="op">)</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span>,color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>,label<span class="op">=</span><span class="va">eqn</span>,parse<span class="op">=</span><span class="cn">TRUE</span>,size<span class="op">=</span><span class="fl">4</span>,x<span class="op">=</span><span class="fl">4</span>,y<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="fifth-example-fabens-tag-recapture-von-bertalanffy">Fifth Example – Fabens (Tag-Recapture) von Bertalanffy<a class="anchor" aria-label="anchor" href="#fifth-example-fabens-tag-recapture-von-bertalanffy"></a>
</h2>
<p>Using parameterizations of the von Bertalanffy for tag-recapture data<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Generally, require observed lengths at marking, observed lengths at recapture or the change in observed length from marking, and the time-at-large (time difference between marking and recapture).&lt;/p&gt;"><sup>12</sup></a> follows a similar workflow, but with a few different details. First, some of the parameterizations use the change in length as the response variable, whereas others use the length at recapture. The first example here will use Fabens parameterization which uses the change-in-length as the response variable.</p>
<p>Before continuing, this example will use the data in <code>GrowthData3</code>, which is shown below and has variables that are the unique tag number of the fish (<code>tag</code>), the total length at marking/tagging (<code>tlM</code>) and subsequent recapture (<code>tlR</code>), time-at-large (time between marking and recapture; <code>deltat</code>), and change in length (<code>deltaL</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">GrowthData3</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;      tag tlM tlR    deltat deltaL</span></span>
<span><span class="co">#&gt; 1      5 240 335 2.1022151     95</span></span>
<span><span class="co">#&gt; 14   109 285 367 2.1137812     82</span></span>
<span><span class="co">#&gt; 28   218 329 389 2.0448716     60</span></span>
<span><span class="co">#&gt; 43   366 240 328 1.9849893     88</span></span>
<span><span class="co">#&gt; 57   470 295 335 1.0461305     40</span></span>
<span><span class="co">#&gt; 71   564 290 326 0.9713158     36</span></span>
<span><span class="co">#&gt; 85   670 164 291 2.0017494    127</span></span>
<span><span class="co">#&gt; 100  757 334 365 1.0982425     31</span></span>
<span><span class="co">#&gt; 114  901 389 404 1.1392284     15</span></span>
<span><span class="co">#&gt; 128 1000 385 405 1.1120293     20</span></span></code></pre></div>
</div>
<p>The primary explanatory variable in tag-recaptures models in <code>FSA</code> is the time-at-large but the length at marking is also required in many models. Thus, both time-at-large and length at marking will appear in the function created by <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code>. For example, a function to predict the change in length from the time-at-large and length at marking for the Fabens parameterization is created below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">typ</span> <span class="op">&lt;-</span> <span class="st">"von Bertalanffy"</span></span>
<span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="st">"Fabens"</span></span>
<span><span class="op">(</span> <span class="va">vb4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrowthFun.html">makeGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; function (dt, Lm, Linf, K = NULL) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     if (length(Linf) == 2) {</span></span>
<span><span class="co">#&gt;         K &lt;- Linf[[2]]</span></span>
<span><span class="co">#&gt;         Linf &lt;- Linf[[1]]</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     (Linf - Lm) * (1 - exp(-K * dt))</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55a22657e460&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:FSA&gt;</span></span></code></pre></div>
</div>
<p>For example, the predicted change in length for times-at-large of 1, 2, and 3 years and a length-at-marking of 300 mm (and assuming <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>∞</mi></msub><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math>=450 and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>=0.3) is obtained with the following.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vb4</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">300</span>,Linf<span class="op">=</span><span class="fl">450</span>,K<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 38.87727 67.67825 89.01455</span></span></code></pre></div>
</div>
<p>Or the predicted change in length of a 1 year time-at-large for fish with lengths-at-marking of 100, 200, and 300 mm is obtained with the following.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">vb4</span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">200</span>,<span class="fl">300</span><span class="op">)</span>,Linf<span class="op">=</span><span class="fl">450</span>,K<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 90.71362 64.79544 38.87727</span></span></code></pre></div>
</div>
<p>With this understanding the rest of workflow is similar to above with the excecption that the formula in <code><a href="../reference/findGrowthStarts.html">findGrowthStarts()</a></code> will be of the form <code>deltaL~deltat+Lm</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsv4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGrowthStarts.html">findGrowthStarts</a></span><span class="op">(</span><span class="va">deltaL</span><span class="op">~</span><span class="va">deltat</span><span class="op">+</span><span class="va">tlM</span>,data<span class="op">=</span><span class="va">GrowthData3</span>,type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span><span class="op">)</span></span>
<span><span class="va">resv4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">deltaL</span><span class="op">~</span><span class="fu">vb4</span><span class="op">(</span><span class="va">deltat</span>,<span class="va">tlM</span>,<span class="va">Linf</span>,<span class="va">K</span><span class="op">)</span>,data<span class="op">=</span><span class="va">GrowthData3</span>,start<span class="op">=</span><span class="va">rsv4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>Est<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resv4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt;              Est        2.5%       97.5%</span></span>
<span><span class="co">#&gt; Linf 446.3107842 440.4914317 452.5043374</span></span>
<span><span class="co">#&gt; K      0.3091659   0.2943062   0.3245036</span></span></code></pre></div>
</div>
<p>Unfortunately, there is not one single graphic that can be used to summarize the results from fitting the growth model to tag-recapture data. The code below won’t be discussed in detail, though a few important details will be highlighted. First, this plot leverages the fact that the marking and tagging sampling events were generally conducted annually so that the times-at-large were very nearly exactly 1, 2, or 3 years. Second, a data.frame is created that uses the fitted model to predict the change-in-length for those three times-at-large at the minimum observed length-at-marking and the estimated <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>∞</mi></msub><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math>. These predictions will be used to place three fitted lines, one for each rough time-at-large, on the scatterplot of change-in-length versus length-at-marking. Only two points are needed for the lines here because Fabens model assumes a linear decline in change-in-length with increase length-at-marking for each time-at-large.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>tlM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">GrowthData3</span><span class="op">$</span><span class="va">tlM</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv4</span><span class="op">)</span><span class="op">[[</span><span class="st">"Linf"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                  deltat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,times<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pdf</span><span class="op">$</span><span class="va">deltaL</span> <span class="op">&lt;-</span> <span class="fu">vb4</span><span class="op">(</span><span class="va">pdf</span><span class="op">$</span><span class="va">deltat</span>,<span class="va">pdf</span><span class="op">$</span><span class="va">tlM</span>,Linf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv4</span><span class="op">)</span><span class="op">[[</span><span class="st">"Linf"</span><span class="op">]</span><span class="op">]</span>,K<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resv4</span><span class="op">)</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pdf</span></span>
<span><span class="co">#&gt;        tlM deltat    deltaL</span></span>
<span><span class="co">#&gt; 1 158.0000      1  76.67366</span></span>
<span><span class="co">#&gt; 2 158.0000      2 132.95664</span></span>
<span><span class="co">#&gt; 3 158.0000      3 174.27168</span></span>
<span><span class="co">#&gt; 4 446.3108      1   0.00000</span></span>
<span><span class="co">#&gt; 5 446.3108      2   0.00000</span></span>
<span><span class="co">#&gt; 6 446.3108      3   0.00000</span></span></code></pre></div>
</div>
<p>The plotting routine looks more complicated here because the original data.frame is used to place the observed points on the graph, but the predicted data.frame is used to place the lines. In addition, the <code>deltat</code> variable is converted to a factor so that a discrete number of colors would be used. Finally note the use of <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate()</a></code> to add the equation to the plot.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eqn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="va">typ</span>,pname<span class="op">=</span><span class="va">prm</span>,fit<span class="op">=</span><span class="va">resv4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">GrowthData3</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tlM</span>,y<span class="op">=</span><span class="va">deltaL</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">deltat</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             size<span class="op">=</span><span class="fl">2.5</span>,alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">pdf</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tlM</span>,y<span class="op">=</span><span class="va">deltaL</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">deltat</span><span class="op">)</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Change in Length from Marking (mm)"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Total Length-at-Marking (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Years-at-Large"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>,label<span class="op">=</span><span class="va">eqn</span>,parse<span class="op">=</span><span class="cn">TRUE</span>,size<span class="op">=</span><span class="fl">4.2</span>,x<span class="op">=</span><span class="fl">350</span>,y<span class="op">=</span><span class="fl">165</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"inside"</span>,</span>
<span>        legend.position.inside<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-27-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
</section><section class="section level2"><h2 id="exploring-model-parameters">Exploring Model Parameters<a class="anchor" aria-label="anchor" href="#exploring-model-parameters"></a>
</h2>
<p>Understanding the meaning of parameters in the growth functions is important for properly modeling fish growth. One way to learn about the meaning of a parameter is to plot the growth function while varying one parameter and holding the other parameters constant. The growth functions created by <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code> will aid in this process.</p>
<p>For simplicity, a <code>ggplot2</code> theme was created that modified <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw()</a></code> to remove the grid lines and move the legend inside of the plot panel.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theme_grow</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          legend.position<span class="op">=</span><span class="st">"inside"</span>,</span>
<span>          legend.position.inside<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>          legend.justification.inside<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p>In this example, the parameter for the instantaneous growth (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>i</mi></msub><annotation encoding="application/x-tex">g_i</annotation></semantics></math>) at the inflection point ($t_i) in the second parameterization of the Gompertz growth function will be explored. An R function for this parameterization is created below with <code><a href="../reference/makeGrowthFun.html">makeGrowthFun()</a></code> and the corresponding generic equation is created with <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code>. Note that <code>parse=TRUE</code> is used in <code><a href="../reference/showGrowthFun.html">showGrowthFun()</a></code> here because the equation is going to form the title in the ggplot which requires an expression (returned when <code>parse=TRUE</code>) rather than a string that it will parse.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeGrowthFun.html">makeGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"Gompertz"</span>,param<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">feqn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showGrowthFun.html">showGrowthFun</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"Gompertz"</span>,param<span class="op">=</span><span class="fl">2</span>,parse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<p>A data.frame is then created that has all combinations of a sequence of ages over which to show the growth function and values for both the parameter that varies and those that are held constant. In the example below, age will be a sequence from -0.5 to 15 in steps of 0.5<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Smaller steps will make the growth function look smoother.&lt;/p&gt;"><sup>13</sup></a>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>∞</mi></msub><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math> will be held constant at 450, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math> (age at the inflection point) will be held constant at 3, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>i</mi></msub><annotation encoding="application/x-tex">g_i</annotation></semantics></math> will vary from 0.1 to 0.6 in steps of 0.1. Length is then computed from these ages and parameter values using the growth function created above (i.e., <code>f()</code>). Finally, the variable with the parameter that varied is converted to a factor so that the plot created next will use a discrete rather than continuous number of colors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">15</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   Linf<span class="op">=</span><span class="fl">450</span>,gi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.6</span>,<span class="fl">0.1</span><span class="op">)</span>,ti<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Length<span class="op">=</span><span class="fu">f</span><span class="op">(</span><span class="va">Age</span>,<span class="va">Linf</span>,<span class="va">gi</span>,<span class="va">ti</span><span class="op">)</span>,</span>
<span>                gi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">gi</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">tmp</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Age Linf  gi ti   Length</span></span>
<span><span class="co">#&gt; 1   -0.5  450 0.1  3 108.8728</span></span>
<span><span class="co">#&gt; 38   2.0  450 0.2  3 132.6673</span></span>
<span><span class="co">#&gt; 77   5.5  450 0.3  3 280.5862</span></span>
<span><span class="co">#&gt; 115  8.5  450 0.4  3 402.8017</span></span>
<span><span class="co">#&gt; 154 12.0  450 0.5  3 445.0286</span></span>
<span><span class="co">#&gt; 192 15.0  450 0.6  3 449.6642</span></span></code></pre></div>
</div>
<p>These simulated data are then plotted using the parameter that varied to denote <code>color</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Length</span>,x<span class="op">=</span><span class="va">Age</span>,color<span class="op">=</span><span class="va">gi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="va">feqn</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grow</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-31-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>From here one can observe that each instance of this Gompertz function has an infection point at age-3 and that the “rate of growth” at that inflection point is greater as <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>i</mi></msub><annotation encoding="application/x-tex">g_i</annotation></semantics></math> increases, making the growth function look more “S-shaped.”</p>
<p>Of course, the method can be easily modified for another parameter.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">15</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   Linf<span class="op">=</span><span class="fl">450</span>,gi<span class="op">=</span><span class="fl">0.5</span>,ti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Length<span class="op">=</span><span class="fu">f</span><span class="op">(</span><span class="va">Age</span>,<span class="va">Linf</span>,<span class="va">gi</span>,<span class="va">ti</span><span class="op">)</span>,</span>
<span>                ti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ti</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Length</span>,x<span class="op">=</span><span class="va">Age</span>,color<span class="op">=</span><span class="va">ti</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="va">feqn</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grow</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-32-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>It is possible to change two parameters at once, though this can become messy so it is best to vary the parameters at fewer values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">15</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   Linf<span class="op">=</span><span class="fl">450</span>,gi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">0.1</span><span class="op">)</span>,ti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Length<span class="op">=</span><span class="fu">f</span><span class="op">(</span><span class="va">Age</span>,<span class="va">Linf</span>,<span class="va">gi</span>,<span class="va">ti</span><span class="op">)</span>,</span>
<span>                gi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">gi</span><span class="op">)</span>,</span>
<span>                ti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ti</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Length</span>,x<span class="op">=</span><span class="va">Age</span>,color<span class="op">=</span><span class="va">gi</span>,linetype<span class="op">=</span><span class="va">ti</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="va">feqn</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grow</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
<p>Finally, you can be more creative/instructive. For example, the instantaneous growth rate can be estimated by dividing the difference in successive log lengths by the difference in successive ages.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span>,<span class="fl">0.01</span><span class="op">)</span>,</span>
<span>                   Linf<span class="op">=</span><span class="fl">450</span>,gi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">0.1</span><span class="op">)</span>,ti<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Length<span class="op">=</span><span class="fu">f</span><span class="op">(</span><span class="va">Age</span>,<span class="va">Linf</span>,<span class="va">gi</span>,<span class="va">ti</span><span class="op">)</span>,</span>
<span>                gi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">gi</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>est_g<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>,<span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">tmp</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Age Linf  gi ti    Length     est_g</span></span>
<span><span class="co">#&gt; 1    0.00  450 0.3  3  38.46099 0.7367752</span></span>
<span><span class="co">#&gt; 481  4.80  450 0.3  3 251.26278 0.1745625</span></span>
<span><span class="co">#&gt; 962  3.60  450 0.4  3 204.92001 0.3140227</span></span>
<span><span class="co">#&gt; 1442 2.39  450 0.5  3 115.88781 0.6766195</span></span>
<span><span class="co">#&gt; 1923 1.19  450 0.6  3  23.26260 1.7721188</span></span>
<span><span class="co">#&gt; 2404 6.00  450 0.6  3 381.43814        NA</span></span></code></pre></div>
</div>
<p>The plot of the estimated instantaneous growth rates against age, zoomed in to focus on the inflection points, with reference lines at <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math> and the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>i</mi></msub><annotation encoding="application/x-tex">g_i</annotation></semantics></math> illustrates that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>i</mi></msub><annotation encoding="application/x-tex">g_i</annotation></semantics></math> is indeed the instantaneous growth rate at the inflection point.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tmp</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">est_g</span>,x<span class="op">=</span><span class="va">Age</span>,color<span class="op">=</span><span class="va">gi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="va">feqn</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_grow</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position.inside<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span><span class="op">)</span>,linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">3</span>,linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 976 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="Fitting_Growth_Functions_files/figure-html/unnamed-chunk-35-1.png" class="quarto-figure quarto-figure-center" width="432"></p>
</figure>
</div>
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://derekogle.com" class="external-link">Derek H. Ogle</a>, Jason C. Doll, A. Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
