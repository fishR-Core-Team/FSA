<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Computing Proportional Size Distribution Metrics in FSA • FSA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="Computing_PSDs_files/libs/quarto-html/popper.min.js"></script><script src="Computing_PSDs_files/libs/quarto-html/tippy.umd.min.js"></script><link href="Computing_PSDs_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Computing_PSDs_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computing Proportional Size Distribution Metrics in FSA">
<meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Computing_PSDs.html">Computing Proportional Size Distribution Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Computing_Relative_Weights.html">Computing Relative Weights</a></li>
    <li><a class="dropdown-item" href="../articles/Fitting_Growth_Functions.html">Fitting Growth Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Growth_Starting_Values.html">Explaining Starting Values for Growth Functions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto FSA home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA" aria-label="Goto FSA github page"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Computing Proportional Size Distribution Metrics in FSA</h1>

      <p class="author">Derek H. Ogle</p>
      <p class="date">2025-04-24</p>

      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/dev/vignettes/articles/Computing_PSDs.qmd" class="external-link"><code>vignettes/articles/Computing_PSDs.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Summarizing the size structure of fish populations is a common practice for informing fisheries management decisions. One common method for summarizing size structures in North America is to compute the percentage of fish that have reached some minimum size that have also reached a more advanced size. These sizes have been standardized for a number of common North American game fishes and are generally called Gabelhouse lengths, after the author that first described them. The specific percentages are called <em>proportional size distribution</em> (PSD) metrics, and are described in detail in various resources, including <a href="https://derekogle.com/IFAR/" class="external-link">Ogle (2015)</a>. This article assumes you understand the basics of PSD calculations and will show how to make those calculations using functions in the <code>FSA</code> package.</p>
<p>The following packages are used herein. Note that the <code>FSA</code> functions described here were modified after version 0.9.6 and are thus <strong>specific to FSA &gt;v0.9.6</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fishr-core-team.github.io/FSA/">FSA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>  <span class="co"># mutate, select, group_by, summarize</span></span></code></pre></div>
</div>
</section><section class="section level2"><h2 id="creating-psd-related-length-categories">Creating PSD-Related Length Categories<a class="anchor" aria-label="anchor" href="#creating-psd-related-length-categories"></a>
</h2>
<section class="level2"><h3 id="gabelhouse-length-categories">Gabelhouse Length Categories<a class="anchor" aria-label="anchor" href="#gabelhouse-length-categories"></a>
</h3>
<p>Five-cell Gabelhouse (GH) length categories have been deveoped for a number of freshwater game fish in the United States, as well as several non-game fish in the United States and some other fish from outside of the United States. These values have been collated into the <code>PSDlit</code> data.frame<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Specifics &lt;a href="https://fishr-core-team.github.io/FSA/reference/PSDlit.html"&gt;here&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a> distributed with <code>FSA</code> and are most easily accessed with <code><a href="../reference/psdVal.html">psdVal()</a></code>. For example, the GH length categories for Bluegill are retrieved below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Bluegill"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0        80       150       200       250       300</span></span></code></pre></div>
</div>
<p>The default is to return lengths in millimeters; however, they can be returned in centimeters or inches with <code>units=</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Bluegill"</span>,units<span class="op">=</span><span class="st">"cm"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0         8        15        20        25        30</span></span>
<span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Bluegill"</span>,units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0         3         6         8        10        12</span></span></code></pre></div>
</div>
<p>By default, a sixth cell is included that is labeled as “substock” and will always have the value of 0. This can be useful for data that includes individuals shorter than the stock length. Use <code>incl.zero=FALSE</code> to exclude this category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Bluegill"</span>,incl.zero<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;        80       150       200       250       300</span></span></code></pre></div>
</div>
<p>Use of <code><a href="../reference/psdVal.html">psdVal()</a></code> requires spelling (and capitalizing) the species name as it appears in <code>PSDlit</code>. One can see all species names available in <code>PSDlit</code> with <code><a href="../reference/psdVal.html">psdVal()</a></code> without any arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Species name must be one of following. Be careful of spelling and capitalization.</span></span>
<span><span class="co">#&gt;  [1] "Arctic Grayling"           "Bighead Carp"             </span></span>
<span><span class="co">#&gt;  [3] "Bigmouth Buffalo"          "Black Bullhead"           </span></span>
<span><span class="co">#&gt;  [5] "Black Carp"                "Black Crappie"            </span></span>
<span><span class="co">#&gt;  [7] "Blue Catfish"              "Bluegill"                 </span></span>
<span><span class="co">#&gt;  [9] "Brook Trout"               "Brown Bullhead"           </span></span>
<span><span class="co">#&gt; [11] "Brown Trout"               "Bull Trout"               </span></span>
<span><span class="co">#&gt; [13] "Burbot"                    "Chain Pickerel"           </span></span>
<span><span class="co">#&gt; [15] "Channel Catfish"           "Chinook Salmon"           </span></span>
<span><span class="co">#&gt; [17] "Common Carp"               "Cutthroat Trout"          </span></span>
<span><span class="co">#&gt; [19] "Flathead Catfish"          "Freshwater Drum"          </span></span>
<span><span class="co">#&gt; [21] "Gizzard Shad"              "Golden Trout"             </span></span>
<span><span class="co">#&gt; [23] "Goldeye"                   "Grass Carp"               </span></span>
<span><span class="co">#&gt; [25] "Green Sunfish"             "Kokanee"                  </span></span>
<span><span class="co">#&gt; [27] "Lake Chubsucker"           "Lake Trout"               </span></span>
<span><span class="co">#&gt; [29] "Largemouth Bass"           "Longnose Gar"             </span></span>
<span><span class="co">#&gt; [31] "Muskellunge"               "Northern Pike"            </span></span>
<span><span class="co">#&gt; [33] "Northern Snakehead"        "Paddlefish"               </span></span>
<span><span class="co">#&gt; [35] "Pallid Sturgeon"           "Palmetto Bass"            </span></span>
<span><span class="co">#&gt; [37] "Pumpkinseed"               "Rainbow Trout"            </span></span>
<span><span class="co">#&gt; [39] "Redbreast Sunfish"         "Redear Sunfish"           </span></span>
<span><span class="co">#&gt; [41] "River Carpsucker"          "Rock Bass"                </span></span>
<span><span class="co">#&gt; [43] "Ruffe"                     "Sauger"                   </span></span>
<span><span class="co">#&gt; [45] "Saugeye"                   "Shoal Bass"               </span></span>
<span><span class="co">#&gt; [47] "Shorthead Redhorse"        "Silver Carp"              </span></span>
<span><span class="co">#&gt; [49] "Smallmouth Bass"           "Smallmouth Buffalo "      </span></span>
<span><span class="co">#&gt; [51] "Splake"                    "Spotted Bass"             </span></span>
<span><span class="co">#&gt; [53] "Spotted Gar"               "Spotted Sunfish"          </span></span>
<span><span class="co">#&gt; [55] "Striped Bass"              "Striped Bass X White Bass"</span></span>
<span><span class="co">#&gt; [57] "Suwannee Bass"             "Utah Chub"                </span></span>
<span><span class="co">#&gt; [59] "Walleye"                   "Warmouth"                 </span></span>
<span><span class="co">#&gt; [61] "White Bass"                "White Catfish"            </span></span>
<span><span class="co">#&gt; [63] "White Crappie"             "White Perch"              </span></span>
<span><span class="co">#&gt; [65] "White Sucker"              "Yellow Bass"              </span></span>
<span><span class="co">#&gt; [67] "Yellow Bullhead"           "Yellow Perch"</span></span></code></pre></div>
</div>
<p>All parts of the species names in <code>PSDlit</code> are capitalized (e.g., “Brown Trout” and not “brown trout” or “Brown trout”). <code><a href="../reference/psdVal.html">psdVal()</a></code> will return an informative error message if your capitalization is not correct but the message will be less informative if your spelling is off.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Brown trout"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: There are no Gablehouse lengths in 'PSDlit' for "Brown trout". However,</span></span>
<span><span class="co">#&gt;   there is an entry for "Brown Trout" (note spelling, including</span></span>
<span><span class="co">#&gt;   capitalization).</span></span>
<span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Brwn Trout"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: There are no Gablehouse lengths in 'PSDlit' for "Brwn Trout". Type</span></span>
<span><span class="co">#&gt;   'psdVal()' to see a list of available species.</span></span></code></pre></div>
</div>
<p>A small number of species have separate length designations for sub-groups of the species. One way to determine this is to simply try a species in <code><a href="../reference/psdVal.html">psdVal()</a></code> to see if you receive an informative error about the sub-groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Brown Trout"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: "Brown Trout" has Gabelhouse categories for these sub-groups: "lentic"</span></span>
<span><span class="co">#&gt;   and "lotic". Please use 'group=' to select one of these groups.</span></span></code></pre></div>
</div>
<p>Then try again with <code>group=</code> as suggested to select a specific group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Brown Trout"</span>,group<span class="op">=</span><span class="st">"lotic"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0       150       230       300       380       460</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="additional-length-categories">Additional Length Categories<a class="anchor" aria-label="anchor" href="#additional-length-categories"></a>
</h3>
<p>There may be times when you desire length categories in addition to the GH lengths. For example, suppose that the minimum length limit for Largemouth Bass is 254 mm. This length can be included as one of the categories by including a vector with the length (or lengths) to <code>addLens=</code>. If the item in the vector is named (second example below) then the value will also be named in the returned result.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Largemouth Bass"</span>,addLens<span class="op">=</span><span class="fl">254</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock       254   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0       200       254       300       380       510       630</span></span>
<span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Largemouth Bass"</span>,addLens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minLen"</span><span class="op">=</span><span class="fl">254</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock    minLen   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0       200       254       300       380       510       630</span></span></code></pre></div>
</div>
<p>Multiple additional lengths can be included.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Largemouth Bass"</span>,addLens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minSlot"</span><span class="op">=</span><span class="fl">254</span>,<span class="st">"maxSlot"</span><span class="op">=</span><span class="fl">356</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock   minSlot   quality   maxSlot preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0       200       254       300       356       380       510       630</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="adding-length-category-variable-for-one-species">Adding Length Category Variable for One Species<a class="anchor" aria-label="anchor" href="#adding-length-category-variable-for-one-species"></a>
</h2>
<section class="level2"><h3 id="manual-additions">“Manual” Additions<a class="anchor" aria-label="anchor" href="#manual-additions"></a>
</h3>
<p>Suppose that we want to add another variable with the GH length categories to the data.frame of lengths (along with capture location) for Yellow Perch from Saginaw Bay, MI in <code>YPerchSB1</code> (distributed with the <code>FSAdata</code> package). Note here that lengths are in <strong>centimeters</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">YPerchSB1</span>,package<span class="op">=</span><span class="st">"FSAdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">YPerchSB1</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        tl   loc</span></span>
<span><span class="co">#&gt; 1     7.4 inner</span></span>
<span><span class="co">#&gt; 230  10.8 inner</span></span>
<span><span class="co">#&gt; 461  13.9 inner</span></span>
<span><span class="co">#&gt; 691  15.4 inner</span></span>
<span><span class="co">#&gt; 922  18.1 inner</span></span>
<span><span class="co">#&gt; 1152 21.1 inner</span></span>
<span><span class="co">#&gt; 1383 14.6 outer</span></span>
<span><span class="co">#&gt; 1613 18.0 outer</span></span>
<span><span class="co">#&gt; 1844 21.8 outer</span></span>
<span><span class="co">#&gt; 2074 29.9 outer</span></span></code></pre></div>
</div>
<p>First, save the GH length categories returned from <code><a href="../reference/psdVal.html">psdVal()</a></code> to an object (here called <code>ghYP</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">ghYP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/psdVal.html">psdVal</a></span><span class="op">(</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt;  substock     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;         0        13        20        25        30        38</span></span></code></pre></div>
</div>
<p>Then use <code><a href="../reference/lencat.html">lencat()</a></code> with the length variable as the first argument and the GH length categories object in <code>breaks=</code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This examples follows my preference of using &lt;code&gt;dplyr&lt;/code&gt; functions. This could also be accomplished with &lt;code&gt;YPerchSB1$ghcats1 &amp;lt;- lencat(YPerchSB1$tl,breaks=ghYP)&lt;/code&gt;.&lt;/p&gt;"><sup>2</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">YPerchSB1</span> <span class="op">&lt;-</span> <span class="va">YPerchSB1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ghcats1<span class="op">=</span><span class="fu"><a href="../reference/lencat.html">lencat</a></span><span class="op">(</span><span class="va">tl</span>,breaks<span class="op">=</span><span class="va">ghYP</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">YPerchSB1</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        tl   loc ghcats1</span></span>
<span><span class="co">#&gt; 1     7.4 inner       0</span></span>
<span><span class="co">#&gt; 230  10.8 inner       0</span></span>
<span><span class="co">#&gt; 461  13.9 inner      13</span></span>
<span><span class="co">#&gt; 691  15.4 inner      13</span></span>
<span><span class="co">#&gt; 922  18.1 inner      13</span></span>
<span><span class="co">#&gt; 1152 21.1 inner      20</span></span>
<span><span class="co">#&gt; 1383 14.6 outer      13</span></span>
<span><span class="co">#&gt; 1613 18.0 outer      13</span></span>
<span><span class="co">#&gt; 1844 21.8 outer      20</span></span>
<span><span class="co">#&gt; 2074 29.9 outer      25</span></span></code></pre></div>
</div>
<p>By default, <code><a href="../reference/lencat.html">lencat()</a></code> creates a variable with the length values rather than the category names. Use <code>use.names=TRUE</code> to use category names instead.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Added here as a second variable only for demonstration. Generally, you would use one format or the other.&lt;/p&gt;"><sup>3</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">YPerchSB1</span> <span class="op">&lt;-</span> <span class="va">YPerchSB1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ghcats2<span class="op">=</span><span class="fu"><a href="../reference/lencat.html">lencat</a></span><span class="op">(</span><span class="va">tl</span>,breaks<span class="op">=</span><span class="va">ghYP</span>,use.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">YPerchSB1</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        tl   loc ghcats1   ghcats2</span></span>
<span><span class="co">#&gt; 1     7.4 inner       0  substock</span></span>
<span><span class="co">#&gt; 230  10.8 inner       0  substock</span></span>
<span><span class="co">#&gt; 461  13.9 inner      13     stock</span></span>
<span><span class="co">#&gt; 691  15.4 inner      13     stock</span></span>
<span><span class="co">#&gt; 922  18.1 inner      13     stock</span></span>
<span><span class="co">#&gt; 1152 21.1 inner      20   quality</span></span>
<span><span class="co">#&gt; 1383 14.6 outer      13     stock</span></span>
<span><span class="co">#&gt; 1613 18.0 outer      13     stock</span></span>
<span><span class="co">#&gt; 1844 21.8 outer      20   quality</span></span>
<span><span class="co">#&gt; 2074 29.9 outer      25 preferred</span></span></code></pre></div>
</div>
<p>A frequency table can then be used to find the number of individuals in each category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">ghcats2</span>,data<span class="op">=</span><span class="va">YPerchSB1</span><span class="op">)</span></span>
<span><span class="co">#&gt; ghcats2</span></span>
<span><span class="co">#&gt;  substock     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;       448      1267       268        91         0         0</span></span></code></pre></div>
</div>
<p>The reverse cumulative sum of these values, with the substock fish removed, divided by the stock-length sum times 100 are the PSD-X values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rcumsum.html">rcumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">ghcats2</span>,data<span class="op">=</span><span class="va">YPerchSB1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="co">#&gt;     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;      1626       359        91         0         0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">/</span><span class="va">tmp</span><span class="op">[</span><span class="st">"stock"</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;     100.0      22.1       5.6       0.0       0.0</span></span></code></pre></div>
</div>
<p>So, for example, 22.1% of fish that reach stock-size also reached quality-size (i.e., “PSD-Q”).</p>
</section><section class="level2"><h3 id="use-the-psdadd-convenience-function">Use the <code>psdAdd()</code> Convenience Function<a class="anchor" aria-label="anchor" href="#use-the-psdadd-convenience-function"></a>
</h3>
<p><code><a href="../reference/psdAdd.html">psdAdd()</a></code> can be used to add a length categorization variable to a data.frame for <strong>all</strong> species in the data.frame for which the GH length categories exists. The main argument to <code><a href="../reference/psdAdd.html">psdAdd()</a></code> is a formula of the form <code>length~species</code>, where <code>length</code> is the observed length variable and <code>species</code> is the name of the species variable. Again, the species must be spelled (and capitalized) as in <code>PSDlit</code>. In these data there is no variable that identified the species, likely because the data contains only one species. Thus, for this example, before <code><a href="../reference/psdAdd.html">psdAdd()</a></code> can be used, a new variable with the species name must be added.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">YPerchSB1</span> <span class="op">&lt;-</span> <span class="va">YPerchSB1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>species<span class="op">=</span><span class="st">"Yellow Perch"</span>,</span>
<span>         ghcats3<span class="op">=</span><span class="fu"><a href="../reference/psdAdd.html">psdAdd</a></span><span class="op">(</span><span class="va">tl</span><span class="op">~</span><span class="va">species</span>,units<span class="op">=</span><span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">YPerchSB1</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;        tl   loc ghcats1   ghcats2      species   ghcats3</span></span>
<span><span class="co">#&gt; 1     7.4 inner       0  substock Yellow Perch  substock</span></span>
<span><span class="co">#&gt; 230  10.8 inner       0  substock Yellow Perch  substock</span></span>
<span><span class="co">#&gt; 461  13.9 inner      13     stock Yellow Perch     stock</span></span>
<span><span class="co">#&gt; 691  15.4 inner      13     stock Yellow Perch     stock</span></span>
<span><span class="co">#&gt; 922  18.1 inner      13     stock Yellow Perch     stock</span></span>
<span><span class="co">#&gt; 1152 21.1 inner      20   quality Yellow Perch   quality</span></span>
<span><span class="co">#&gt; 1383 14.6 outer      13     stock Yellow Perch     stock</span></span>
<span><span class="co">#&gt; 1613 18.0 outer      13     stock Yellow Perch     stock</span></span>
<span><span class="co">#&gt; 1844 21.8 outer      20   quality Yellow Perch   quality</span></span>
<span><span class="co">#&gt; 2074 29.9 outer      25 preferred Yellow Perch preferred</span></span></code></pre></div>
</div>
<p>The PSD-X metrics can then be computed as before.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rcumsum.html">rcumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">ghcats3</span>,data<span class="op">=</span><span class="va">YPerchSB1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span></span>
<span><span class="co">#&gt;     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;      1626       359        91         0         0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">/</span><span class="va">tmp</span><span class="op">[</span><span class="st">"stock"</span><span class="op">]</span><span class="op">*</span><span class="fl">100</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;     stock   quality preferred memorable    trophy </span></span>
<span><span class="co">#&gt;     100.0      22.1       5.6       0.0       0.0</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="using-psdcalc-to-compute-all-psd-x-and-psd-x-y-values-for-one-species">Using <code>psdCalc()</code> to Compute All PSD-X and PSD-X-Y Values for One Species<a class="anchor" aria-label="anchor" href="#using-psdcalc-to-compute-all-psd-x-and-psd-x-y-values-for-one-species"></a>
</h2>
<p>All of that (in the previous sections) is a bit tedious and, more importantly, does not compute confidence intervals for the values.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See &lt;code&gt;&lt;a href="../reference/psdCI.html"&gt;psdCI()&lt;/a&gt;&lt;/code&gt; for how to compute confidence intervals from the raw data.&lt;/p&gt;'><sup>4</sup></a> <code><a href="../reference/psdCalc.html">psdCalc()</a></code> provides a convenient interface for computing all of the PSD metrics, with confidence intervals, for a data.frame with one species. Before illustrating <code><a href="../reference/psdCalc.html">psdCalc()</a></code>, I returned to the original <code>YPerchSB1</code> data.frame without the changes made in the previous sections.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">YPerchSB1</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;        tl   loc</span></span>
<span><span class="co">#&gt; 1     7.4 inner</span></span>
<span><span class="co">#&gt; 415  14.9 inner</span></span>
<span><span class="co">#&gt; 830  16.3 inner</span></span>
<span><span class="co">#&gt; 1244  7.6 outer</span></span>
<span><span class="co">#&gt; 1659 18.5 outer</span></span>
<span><span class="co">#&gt; 2074 29.9 outer</span></span></code></pre></div>
</div>
<p><code><a href="../reference/psdCalc.html">psdCalc()</a></code> takes a formula of the form <code>~length</code> as the first argument with the appropriate data.frame in <code>data=</code>. As with <code><a href="../reference/psdVal.html">psdVal()</a></code>, <code><a href="../reference/psdCalc.html">psdCalc()</a></code> requires the correctly spelled (and capitalized) species name in <code>species=</code> and units in <code>units=</code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Again, &lt;code&gt;units=&lt;/code&gt; defaults to &lt;code&gt;mm&lt;/code&gt;.&lt;/p&gt;"><sup>5</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-Q         22      20      25</span></span>
<span><span class="co">#&gt; PSD-P          6       4       7</span></span>
<span><span class="co">#&gt; PSD S-Q       78      75      80</span></span>
<span><span class="co">#&gt; PSD Q-P       16      14      19</span></span>
<span><span class="co">#&gt; PSD P-M        6       4       7</span></span></code></pre></div>
</div>
<p>By default, PSD metrics that are 0 are dropped from the results. They can be included by using <code>drop0Est=FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,drop0Est<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-Q         22      20      25</span></span>
<span><span class="co">#&gt; PSD-P          6       4       7</span></span>
<span><span class="co">#&gt; PSD-M          0      NA      NA</span></span>
<span><span class="co">#&gt; PSD-T          0      NA      NA</span></span>
<span><span class="co">#&gt; PSD S-Q       78      75      80</span></span>
<span><span class="co">#&gt; PSD Q-P       16      14      19</span></span>
<span><span class="co">#&gt; PSD P-M        6       4       7</span></span>
<span><span class="co">#&gt; PSD M-T        0      NA      NA</span></span></code></pre></div>
</div>
<p>The PSD-X (in contrast to PSD X-Y) values are referred to here as “traditional” PSD metrics as they show the percent of stock-sized fish that were also X-sized. For example, PSD-P is the percent of stock-sized fish that also reach preferred-size. In this example, 6% (95%CI: 4%-7%) of stock-sized fish attained preferred size.</p>
<p>Just the “traditional” metrics may be returned by including <code>what="traditional"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,what<span class="op">=</span><span class="st">"traditional"</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-Q       22      20      25</span></span>
<span><span class="co">#&gt; PSD-P        6       4       7</span></span></code></pre></div>
</div>
<p>The PSD X-Y values are referred to here as “incremental” PSD metrics as they show the percent of stock-sized fish that were between X- and Y-sized. For example, PSD Q-P is the percent of stock-sized fish that reached quality-size but had not reach preferred-size. In this example, 16% (95%CI: 14%-19%) of stock-sized fish attained quality but not preferred size.</p>
<p>Just the “incremental” metrics may be returned by including <code>what="incremental"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,what<span class="op">=</span><span class="st">"incremental"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD S-Q       78      75      80</span></span>
<span><span class="co">#&gt; PSD Q-P       16      14      19</span></span>
<span><span class="co">#&gt; PSD P-M        6       4       7</span></span></code></pre></div>
</div>
<p>Sometimes<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;For example, when teaching.&lt;/p&gt;"><sup>6</sup></a> it is useful to see the intermediate values (i.e., the numbers) that were used to calculate the PSD metrics. These values can be included in the results by including <code>showIntermediate=TRUE</code>. In each line below, the “Estimate” should be “num” divided by “stock” times 100 (and then rounded to a whole number).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,</span>
<span>        drop0Est<span class="op">=</span><span class="cn">FALSE</span>,showIntermediate<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;          num stock Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-Q    358  1626       22      20      25</span></span>
<span><span class="co">#&gt; PSD-P     98  1626        6       4       7</span></span>
<span><span class="co">#&gt; PSD-M      0  1626        0      NA      NA</span></span>
<span><span class="co">#&gt; PSD-T      0  1626        0      NA      NA</span></span>
<span><span class="co">#&gt; PSD S-Q 1268  1626       78      75      80</span></span>
<span><span class="co">#&gt; PSD Q-P  260  1626       16      14      19</span></span>
<span><span class="co">#&gt; PSD P-M   98  1626        6       4       7</span></span>
<span><span class="co">#&gt; PSD M-T    0  1626        0      NA      NA</span></span></code></pre></div>
</div>
<p>Additional lengths may be included in <code><a href="../reference/psdCalc.html">psdCalc()</a></code> as described for <code><a href="../reference/psdVal.html">psdVal()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,</span>
<span>        addLens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17.5</span>,<span class="fl">27.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-17.5         53      49      56</span></span>
<span><span class="co">#&gt; PSD-Q            22      19      25</span></span>
<span><span class="co">#&gt; PSD-P             6       4       7</span></span>
<span><span class="co">#&gt; PSD-27.5          2       1       3</span></span>
<span><span class="co">#&gt; PSD S-17.5       47      44      51</span></span>
<span><span class="co">#&gt; PSD 17.5-Q       30      27      34</span></span>
<span><span class="co">#&gt; PSD Q-P          16      14      19</span></span>
<span><span class="co">#&gt; PSD P-27.5        4       2       5</span></span>
<span><span class="co">#&gt; PSD 27.5-M        2       1       3</span></span>
<span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,</span>
<span>        addLens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"minSlot"</span><span class="op">=</span><span class="fl">17.5</span>,<span class="st">"maxSlot"</span><span class="op">=</span><span class="fl">27.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-minSlot         53      49      56</span></span>
<span><span class="co">#&gt; PSD-Q               22      19      25</span></span>
<span><span class="co">#&gt; PSD-P                6       4       7</span></span>
<span><span class="co">#&gt; PSD-maxSlot          2       1       3</span></span>
<span><span class="co">#&gt; PSD S-minSlot       47      44      51</span></span>
<span><span class="co">#&gt; PSD minSlot-Q       30      27      34</span></span>
<span><span class="co">#&gt; PSD Q-P             16      14      19</span></span>
<span><span class="co">#&gt; PSD P-maxSlot        4       2       5</span></span>
<span><span class="co">#&gt; PSD maxSlot-M        2       1       3</span></span></code></pre></div>
</div>
<section class="level2"><h3 id="using-psdplot-to-visualize-the-psd-metrics">Using <code>psdPlot()</code> to Visualize the PSD Metrics<a class="anchor" aria-label="anchor" href="#using-psdplot-to-visualize-the-psd-metrics"></a>
</h3>
<p><code><a href="../reference/psdPlot.html">psdPlot()</a></code> can be used to produce a histogram of lengths with different colors for substock- and stock-size fish, vertical lines depicting the GH length categories, and the “traditional” PSD metrics shown. The basic arguments to <code><a href="../reference/psdPlot.html">psdPlot()</a></code> are the same as those to <code><a href="../reference/psdCalc.html">psdCalc()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdPlot.html">psdPlot</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Computing_PSDs_files/figure-html/unnamed-chunk-27-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<p>There may be times where the length category lines don’t fall on the breaks for the histogram bars. You may be able to ameliorate this issue by changing the width of the breaks with <code>w=</code> or where the breaks start with <code>startcat=</code>.<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;While this was not an issue with these data, this code shows how to make narrower bar widths with &lt;code&gt;w=&lt;/code&gt;.&lt;/p&gt;"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psdPlot.html">psdPlot</a></span><span class="op">(</span><span class="op">~</span><span class="va">tl</span>,data<span class="op">=</span><span class="va">YPerchSB1</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"cm"</span>,w<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="Computing_PSDs_files/figure-html/unnamed-chunk-28-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<p>This plot is meant to be illustrative and not of “publication-quality.” However, some aspects of the plot can be modified to make some changes in appearance. See <code><a href="../reference/psdPlot.html">?psdPlot</a></code> for documentation of these other arguments.</p>
</section></section><section class="section level2"><h2 id="adding-a-length-category-variable-for-all-species">Adding a Length Category Variable for All Species<a class="anchor" aria-label="anchor" href="#adding-a-length-category-variable-for-all-species"></a>
</h2>
<p>The real value of <code><a href="../reference/psdAdd.html">psdAdd()</a></code> is that it can be used to efficiently add length categories for multiple species in a single data.frame. For example, <code>InchLake2</code> distributed with <code>FSAdata</code> contains lengths for several species captured from Inch Lake. Note that lengths are in <strong>inches</strong> here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"InchLake2"</span>,package<span class="op">=</span><span class="st">"FSAdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">InchLake2</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;     netID fishID          species length weight year</span></span>
<span><span class="co">#&gt; 1     206    501         Bluegill    1.5    0.7 2008</span></span>
<span><span class="co">#&gt; 57     16    208    Black Crappie   11.6  380.0 2007</span></span>
<span><span class="co">#&gt; 115   101    583         Bluegill    5.5   48.0 2008</span></span>
<span><span class="co">#&gt; 172   102    642 Bluntnose Minnow    2.1    1.3 2008</span></span>
<span><span class="co">#&gt; 229   116    760  Largemouth Bass    2.8    2.0 2008</span></span>
<span><span class="co">#&gt; 287   109    843  Largemouth Bass   13.1  460.0 2008</span></span>
<span><span class="co">#&gt; 344   130    902  Largemouth Bass   10.1  173.0 2008</span></span>
<span><span class="co">#&gt; 401     6    178         Bluegill    6.2   62.0 2007</span></span>
<span><span class="co">#&gt; 459    12     45 Bluntnose Minnow    2.7    6.0 2007</span></span>
<span><span class="co">#&gt; 516     4    127         Bluegill    6.6   90.0 2007</span></span></code></pre></div>
</div>
<p><code><a href="../reference/psdAdd.html">psdAdd()</a></code> can be used as described previously (i.e., with a formula of the form <code>length~species</code> and <code>units=</code>) to add GH length categories for all species in the data.frame for which GH length categories exist in <code>PSDlit</code>. Note that a message will be issued identifying the species in the data.frame for which GH length categories do not exist. The new variable will be <code>NA</code> for these species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">InchLake2</span> <span class="op">&lt;-</span> <span class="va">InchLake2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ghcats1<span class="op">=</span><span class="fu"><a href="../reference/psdAdd.html">psdAdd</a></span><span class="op">(</span><span class="va">length</span><span class="op">~</span><span class="va">species</span>,units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Species in the data with no Gabelhouse (PSD) lengths in `PSDlit`: "Iowa</span></span>
<span><span class="co">#&gt;   Darter", "Bluntnose Minnow", "Tadpole Madtom", and "Fathead Minnow".</span></span>
<span><span class="fu"><a href="../reference/peek.html">peek</a></span><span class="op">(</span><span class="va">InchLake2</span>,n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;     netID fishID          species length weight year   ghcats1</span></span>
<span><span class="co">#&gt; 1     206    501         Bluegill    1.5    0.7 2008  substock</span></span>
<span><span class="co">#&gt; 57     16    208    Black Crappie   11.6  380.0 2007 preferred</span></span>
<span><span class="co">#&gt; 115   101    583         Bluegill    5.5   48.0 2008     stock</span></span>
<span><span class="co">#&gt; 172   102    642 Bluntnose Minnow    2.1    1.3 2008      &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 229   116    760  Largemouth Bass    2.8    2.0 2008  substock</span></span>
<span><span class="co">#&gt; 287   109    843  Largemouth Bass   13.1  460.0 2008   quality</span></span>
<span><span class="co">#&gt; 344   130    902  Largemouth Bass   10.1  173.0 2008     stock</span></span>
<span><span class="co">#&gt; 401     6    178         Bluegill    6.2   62.0 2007   quality</span></span>
<span><span class="co">#&gt; 459    12     45 Bluntnose Minnow    2.7    6.0 2007      &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 516     4    127         Bluegill    6.6   90.0 2007   quality</span></span></code></pre></div>
</div>
<p>Summaries by species requires some work. First, remove all substock-sized individuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Inch_mod</span> <span class="op">&lt;-</span> <span class="va">InchLake2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ghcats1</span><span class="op">!=</span><span class="st">"substock"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Incremental PSD metrics (i.e, PSD X-Y) are quickly computed with <code><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs()</a></code> and <code><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table()</a></code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/xtabs.html" class="external-link">xtabs</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">+</span><span class="va">ghcats1</span>,data<span class="op">=</span><span class="va">Inch_mod</span><span class="op">)</span></span>
<span><span class="va">iPSDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">freq</span>,margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">iPSDs</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  ghcats1</span></span>
<span><span class="co">#&gt; species           stock quality preferred memorable</span></span>
<span><span class="co">#&gt;   Black Crappie    20.0     0.0      32.0      48.0</span></span>
<span><span class="co">#&gt;   Bluegill         30.4    44.1      25.5       0.0</span></span>
<span><span class="co">#&gt;   Largemouth Bass  32.9    59.8       7.3       0.0</span></span>
<span><span class="co">#&gt;   Pumpkinseed      12.5    75.0      12.5       0.0</span></span>
<span><span class="co">#&gt;   Yellow Perch      0.0    52.2      43.5       4.3</span></span></code></pre></div>
</div>
<p>Traditional PSD metrics (i.e., PSD-X) can be found by <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code>ing <code><a href="../reference/rcumsum.html">rcumsum()</a></code><a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This finds reverse cumulative sums; i.e., sums from end-to-start, rather than start-to-end.&lt;/p&gt;"><sup>8</sup></a> to each row (i.e., <code>MARGIN=1</code>) of the PSD X-Y values. The result from <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code> will be oriented opposite of what is desired (i.e., species a columns rather than rows), so it should be <code><a href="https://rdrr.io/r/base/t.html" class="external-link">t()</a></code>ransposed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tPSDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">iPSDs</span>,MARGIN<span class="op">=</span><span class="fl">1</span>,FUN<span class="op">=</span><span class="va">rcumsum</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tPSDs</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  ghcats1</span></span>
<span><span class="co">#&gt; species           stock quality preferred memorable</span></span>
<span><span class="co">#&gt;   Black Crappie     100    80.0      80.0      48.0</span></span>
<span><span class="co">#&gt;   Bluegill          100    69.6      25.5       0.0</span></span>
<span><span class="co">#&gt;   Largemouth Bass   100    67.1       7.3       0.0</span></span>
<span><span class="co">#&gt;   Pumpkinseed       100    87.5      12.5       0.0</span></span>
<span><span class="co">#&gt;   Yellow Perch      100   100.0      47.8       4.3</span></span></code></pre></div>
</div>
<p>Additional non-GH length categories can be used with <code><a href="../reference/psdAdd.html">psdAdd()</a></code> through <code>addLens()</code> similar to what was described for <code><a href="../reference/psdVal.html">psdVal()</a></code> and <code><a href="../reference/psdCalc.html">psdCalc()</a></code>. However, a named list must be given to <code>addLens()</code> that as named vectors for each species for what an additional length is added. An example for this is given in the documentation for <code><a href="../reference/psdAdd.html">psdAdd()</a></code>.</p>
<p>The use of <code><a href="../reference/psdAdd.html">psdAdd()</a></code> is fairly efficient if interest is only in the point PSD-X or PSD X-Y values. If one needs confidence intervals for these values then it is probably best to use <code><a href="../reference/psdCalc.html">psdCalc()</a></code> on separate data.frames for each species. This is demonstrated below for Yellow Perch and Bluegill from the Inch Lake data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">InchYP</span> <span class="op">&lt;-</span> <span class="va">InchLake2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span><span class="op">==</span><span class="st">"Yellow Perch"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">length</span>,data<span class="op">=</span><span class="va">InchYP</span>,species<span class="op">=</span><span class="st">"Yellow Perch"</span>,units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Some category sample size &lt;20, some CI coverage may be lower than 95%.</span></span>
<span><span class="co">#&gt;         Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-Q        100      NA      NA</span></span>
<span><span class="co">#&gt; PSD-P         48      22      73</span></span>
<span><span class="co">#&gt; PSD-M          4       0      15</span></span>
<span><span class="co">#&gt; PSD Q-P       52      27      78</span></span>
<span><span class="co">#&gt; PSD P-M       43      18      69</span></span>
<span><span class="co">#&gt; PSD M-T        4       0      15</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">InchBG</span> <span class="op">&lt;-</span> <span class="va">InchLake2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span><span class="op">==</span><span class="st">"Bluegill"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/psdCalc.html">psdCalc</a></span><span class="op">(</span><span class="op">~</span><span class="va">length</span>,data<span class="op">=</span><span class="va">InchBG</span>,species<span class="op">=</span><span class="st">"Bluegill"</span>,units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate 95% LCI 95% UCI</span></span>
<span><span class="co">#&gt; PSD-Q         70      61      78</span></span>
<span><span class="co">#&gt; PSD-P         25      17      34</span></span>
<span><span class="co">#&gt; PSD S-Q       30      22      39</span></span>
<span><span class="co">#&gt; PSD Q-P       44      35      54</span></span>
<span><span class="co">#&gt; PSD P-M       25      17      34</span></span></code></pre></div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://derekogle.com" class="external-link">Derek H. Ogle</a>, Jason C. Doll, A. Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
