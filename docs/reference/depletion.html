<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computes the Leslie or DeLury population estimate from catch and effort data. — depletion • FSA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computes the Leslie or DeLury population estimate from catch and effort data. — depletion"><meta name="description" content="Computes the Leslie or DeLury estimates of population size and catchability coefficient from paired catch and effort data. The Ricker modification may also be used."><meta property="og:description" content="Computes the Leslie or DeLury estimates of population size and catchability coefficient from paired catch and effort data. The Ricker modification may also be used."><meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto FSA home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA" aria-label="Goto FSA github page"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Computes the Leslie or DeLury population estimate from catch and effort data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/HEAD/R/depletion.R" class="external-link"><code>R/depletion.R</code></a></small>
      <div class="d-none name"><code>depletion.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the Leslie or DeLury estimates of population size and catchability coefficient from paired catch and effort data. The Ricker modification may also be used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">depletion</span><span class="op">(</span><span class="va">catch</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">depletion</span><span class="op">(</span></span>
<span>  <span class="va">catch</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Leslie"</span>, <span class="st">"DeLury"</span>, <span class="st">"Delury"</span><span class="op">)</span>,</span>
<span>  Ricker.mod <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">depletion</span><span class="op">(</span></span>
<span>  <span class="va">catch</span>,</span>
<span>  <span class="va">effort</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Leslie"</span>, <span class="st">"DeLury"</span>, <span class="st">"Delury"</span><span class="op">)</span>,</span>
<span>  Ricker.mod <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'depletion'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"No"</span>, <span class="st">"q"</span>, <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'depletion'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"No"</span>, <span class="st">"q"</span>, <span class="st">"lm"</span><span class="op">)</span>, as.df <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'depletion'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"No"</span>, <span class="st">"q"</span>, <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="va">conf.level</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  incl.est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'depletion'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'depletion'</span></span>
<span><span class="fu"><a href="rSquared.html">rSquared</a></span><span class="op">(</span><span class="va">object</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>, percent <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'depletion'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  col.pt <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  col.mdl <span class="op">=</span> <span class="st">"gray70"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pos.est <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  cex.est <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-catch">catch<a class="anchor" aria-label="anchor" href="#arg-catch"></a></dt>
<dd><p>A numeric vector of catches of fish at each time, or a formula of the form <code>catch~effort</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for methods.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame from which the variables in the <code>catch</code> formula can be found. Not used if <code>catch</code> is not a formula.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A single string that indicates which depletion method to use</p></dd>


<dt id="arg-ricker-mod">Ricker.mod<a class="anchor" aria-label="anchor" href="#arg-ricker-mod"></a></dt>
<dd><p>A single logical that indicates whether to use the modification proposed by Ricker (=TRUE) or not (=FALSE, default).</p></dd>


<dt id="arg-effort">effort<a class="anchor" aria-label="anchor" href="#arg-effort"></a></dt>
<dd><p>A numeric vector of efforts expended at each time.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object saved from the <code>removal</code> call (i.e., of class <code>depletion</code>).</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>A specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical that indicates whether a reminder of the method used should be printed with the summary results.</p></dd>


<dt id="arg-as-df">as.df<a class="anchor" aria-label="anchor" href="#arg-as-df"></a></dt>
<dd><p>A logical that indicates whether the results of <code>coef</code>, <code>confint</code>, or <code>summary</code> should be returned as a data.frame. Ignored in <code>summary</code> if <code>parm="lm"</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Same as <code>conf.level</code> but used for compatibility with generic <code>confint</code> function.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>A single number that represents the level of confidence to use for constructing confidence intervals.</p></dd>


<dt id="arg-incl-est">incl.est<a class="anchor" aria-label="anchor" href="#arg-incl-est"></a></dt>
<dd><p>A logical that indicated whether the parameter point estimate should be included in the results from <code>confint</code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>The number of digits to round the <code>rSquared</code> result to.</p></dd>


<dt id="arg-percent">percent<a class="anchor" aria-label="anchor" href="#arg-percent"></a></dt>
<dd><p>A logical that indicates if the <code>rSquared</code> result should be returned as a percentage (<code>=TRUE</code>) or as a proportion (<code>=FALSE</code>; default).</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object saved from the <code>depletion</code> call (i.e., of class <code>depletion</code>).</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>A label for the x-axis.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>A label for the y-axis.</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>A numeric that indicates the type of plotting character.</p></dd>


<dt id="arg-col-pt">col.pt<a class="anchor" aria-label="anchor" href="#arg-col-pt"></a></dt>
<dd><p>A string that indicates the color of the plotted points.</p></dd>


<dt id="arg-col-mdl">col.mdl<a class="anchor" aria-label="anchor" href="#arg-col-mdl"></a></dt>
<dd><p>A string that indicates the color of the fitted line.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>A numeric that indicates the line width of the fitted line.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p>A numeric that indicates the type of line used for the fitted line.</p></dd>


<dt id="arg-pos-est">pos.est<a class="anchor" aria-label="anchor" href="#arg-pos-est"></a></dt>
<dd><p>A single string to identify where to place the estimated population estimate and catchability on the plot. Can be set to one of <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> or <code>"center"</code> for positioning the estimated mortality rates on the plot. Typically <code>"bottomleft"</code> (DEFAULT) and <code>"topright"</code> will be “out-of-the-way” placements. Set <code>pos.est</code> to <code>NULL</code> to remove the estimated population size and catchability coefficient from the plot.</p></dd>


<dt id="arg-cex-est">cex.est<a class="anchor" aria-label="anchor" href="#arg-cex-est"></a></dt>
<dd><p>A single numeric that identifies the character expansion value for the estimated population estimate and catchability placed on the plot.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following items:</p><ul><li><p>method A string that indicates whether the <code>"Leslie"</code> or <code>"DeLury"</code> model was used.</p></li>
<li><p>catch The original vector of catches.</p></li>
<li><p>effort The original vector of efforts.</p></li>
<li><p>cpe A computed vector of catch-per-unit-effort for each time.</p></li>
<li><p>KorE A computed vector of cumulative catch (K; Leslie method) or effort (E; DeLury method).</p></li>
<li><p>lm The <code>lm</code> object from the fit of CPE on K (Leslie method) or log(CPE) on E (DeLury method).</p></li>
<li><p>est A 2x2 matrix that contains the estimates and standard errors for No and q.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For the Leslie method, a linear regression model of catch-per-unit-effort on cumulative catch prior to the sample is fit. The catchability coefficient (q) is estimated from the negative of the slope and the initial population size (No) is estimated by dividing the intercept by the catchability coefficient. If <code>Ricker.mod=TRUE</code> then the cumulative catch is modified to be the cumulative catch prior to the sample plus half of the catch of the current sample.</p>
<p>For the DeLury method, a linear regression model of log (catch-per-unit-effort) on cumulative effort is fit. The catchability coefficient (q) is estimated from the negative of the slope and the initial population size (No) is estimated by dividing the intercept as an exponent of e by the catchability coefficient. If <code>Ricker.mod=TRUE</code> then the cumulative effort is modified to be the cumulative effort prior to the sample plus half of the effort of the current sample.</p>
<p>Standard errors for the catchability and population size estimates are computed from formulas on page 298 (for Leslie) and 303 (for DeLury) from Seber (2002). Confidence intervals are computed using standard large-sample normal distribution theory with the regression error df.</p>
    </div>
    <div class="section level2">
    <h2 id="testing">testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
    <p>The Leslie method without the Ricker modification and the DeLury method with the Ricker modification matches the results from <code><a href="https://rdrr.io/pkg/fishmethods/man/deplet.html" class="external-link">deplet</a></code> in <span class="pkg">fishmethods</span> for the <code><a href="https://rdrr.io/pkg/fishmethods/man/darter.html" class="external-link">darter</a></code> (from <span class="pkg">fishmethods</span>), <code><a href="https://fishr-core-team.github.io/FSAdata/reference/LobsterPEI.html">LobsterPEI</a></code> and <code><a href="https://fishr-core-team.github.io/FSAdata/reference/BlueCrab.html">BlueCrab</a></code> from <span class="pkg">FSAdata</span>, and <code><a href="SMBassLS.html">SMBassLS</a></code> for N0 to whole numbers, the SE for No to one decimal, q to seven decimals, and the SE of q to at least five decimals.</p>
<p>The Leslie method matches the results of Seber (2002) for N0, q, and the CI for Q but not the CI for N (which was so far off that it might be that Seber's result is incorrect) for the lobster data and the q and CI for q but the NO or its CI (likely due to lots of rounding in Seber 2002) for the Blue Crab data.</p>
<p>The Leslie and DeLury methods match the results of Ricker (1975) for No and Q but not for the CI of No (Ricker used a very different method to compute CIs).</p>
    </div>
    <div class="section level2">
    <h2 id="ifar-chapter">IFAR Chapter<a class="anchor" aria-label="anchor" href="#ifar-chapter"></a></h2>
    <p>10-Abundance from Depletion Data.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ogle, D.H. 2016. <a href="https://fishr-core-team.github.io/fishR/pages/books.html#introductory-fisheries-analyses-with-r" class="external-link">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Ricker, W.E. 1975. Computation and interpretation of biological statistics of fish populations. Technical Report Bulletin 191, Bulletin of the Fisheries Research Board of Canada. [Was (is?) from http://www.dfo-mpo.gc.ca/Library/1485.pdf.]</p>
<p>Seber, G.A.F. 2002. The Estimation of Animal Abundance. Edward Arnold, Second edition (reprinted).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="removal.html">removal</a></code> for related functionality and <code><a href="https://rdrr.io/pkg/fishmethods/man/deplet.html" class="external-link">deplet</a></code> in <span class="pkg">fishmethods</span> for similar functionality.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Derek H. Ogle, <a href="mailto:DerekOgle51@gmail.com">DerekOgle51@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Leslie model examples</span></span></span>
<span class="r-in"><span><span class="co"># no Ricker modification</span></span></span>
<span class="r-in"><span><span class="va">l1</span> <span class="op">&lt;-</span> <span class="fu">depletion</span><span class="op">(</span><span class="va">SMBassLS</span><span class="op">$</span><span class="va">catch</span>,<span class="va">SMBassLS</span><span class="op">$</span><span class="va">effort</span>,method<span class="op">=</span><span class="st">"Leslie"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate    Std. Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.060296e+03 1.692676e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.484403e-02 3.520491e-03</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l1</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Leslie method was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate    Std. Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.060296e+03 1.692676e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.484403e-02 3.520491e-03</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l1</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1060.296  169.2676</span>
<span class="r-in"><span><span class="fu"><a href="rSquared.html">rSquared</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6896648</span>
<span class="r-in"><span><span class="fu"><a href="rSquared.html">rSquared</a></span><span class="op">(</span><span class="va">l1</span>,digits<span class="op">=</span><span class="fl">1</span>,percent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 69</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           No            q </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.060296e+03 1.484403e-02 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         95% LCI      95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 6.699638e+02 1.450627e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  6.725759e-03 2.296229e-02</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">l1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Est      95% LCI      95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.060296e+03 6.699638e+02 1.450627e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.484403e-02 6.725759e-03 2.296229e-02</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">l1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Est  95% LCI  95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1060.296 669.9638 1450.627</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">l1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span>,parm<span class="op">=</span><span class="st">"q"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Est     95% LCI    95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q 0.01484403 0.006725759 0.02296229</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">l1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span>,parm<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Est     95% LCI      95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 15.73905467 12.25084983 19.227259511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K           -0.01484403 -0.02296229 -0.006725759</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="depletion-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># with Ricker modification</span></span></span>
<span class="r-in"><span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu">depletion</span><span class="op">(</span><span class="va">SMBassLS</span><span class="op">$</span><span class="va">catch</span>,<span class="va">SMBassLS</span><span class="op">$</span><span class="va">effort</span>,method<span class="op">=</span><span class="st">"Leslie"</span>,Ricker.mod<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate    Std. Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.077571e+03 1.778035e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.525078e-02 3.911632e-03</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">l1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Est      95% LCI      95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.060296e+03 6.699638e+02 1.450627e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.484403e-02 6.725759e-03 2.296229e-02</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">l2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="depletion-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## DeLury model examples with no Ricker modification</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu">depletion</span><span class="op">(</span><span class="va">SMBassLS</span><span class="op">$</span><span class="va">catch</span>,<span class="va">SMBassLS</span><span class="op">$</span><span class="va">effort</span>,method<span class="op">=</span><span class="st">"DeLury"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate    Std. Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.098503e+03 1.916049e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.319375e-02 3.585777e-03</span>
<span class="r-in"><span><span class="fu"><a href="rSquared.html">rSquared</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6285719</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">d1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Est      95% LCI      95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.098503e+03 6.566616e+02 1.540345e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.319375e-02 4.924937e-03 2.146257e-02</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="depletion-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Leslie model using formula notation</span></span></span>
<span class="r-in"><span><span class="va">l3</span> <span class="op">&lt;-</span> <span class="fu">depletion</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">effort</span>,data<span class="op">=</span><span class="va">SMBassLS</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">l3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate    Std. Err.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 1.060296e+03 1.692676e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> q  1.484403e-02 3.520491e-03</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Leslie model by group (requires dplyr package)</span></span></span>
<span class="r-in"><span><span class="co"># Dummy example data (lake=="A" is SMBassLS example ... just FYI)</span></span></span>
<span class="r-in"><span><span class="va">tmpdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ct<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">131</span>,<span class="fl">69</span>,<span class="fl">99</span>,<span class="fl">78</span>,<span class="fl">56</span>,<span class="fl">76</span>,<span class="fl">49</span>,<span class="fl">42</span>,<span class="fl">63</span>,<span class="fl">47</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">117</span>,<span class="fl">75</span>,<span class="fl">87</span>,<span class="fl">67</span>,<span class="fl">58</span>,<span class="fl">67</span>,<span class="fl">42</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    ft<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,<span class="fl">7</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    lake<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="fl">10</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   </span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">tmpdf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">lake</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">depletion</span><span class="op">(</span><span class="va">ct</span><span class="op">~</span><span class="va">ft</span>,data<span class="op">=</span><span class="va">.x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                   incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Estimates are suspect as model did not exhibit a significantly (p&gt;0.05) negative slope.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lake        No   No_LCI   No_UCI          q         q_LCI      q_UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    A 1060.2956 669.9638 1450.627 0.01484403  6.725759e-03 0.02296229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    B  881.1601 237.1065 1525.214 0.02270663 -9.206464e-05 0.04550533</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://derekogle.com" class="external-link">Derek H. Ogle</a>, Jason C. Doll, A. Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

