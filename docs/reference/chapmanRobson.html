<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computes Chapman-Robson estimates of S and Z. — chapmanRobson • FSA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computes Chapman-Robson estimates of S and Z. — chapmanRobson"><meta name="description" content="Computes the Chapman-Robson estimates of annual survival rate (S) and instantaneous mortality rate (Z) from catch-at-age data on the descending limb of a catch-curve. Method functions extract estimates with associated standard errors and confidence intervals. A plot method highlights the descending-limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A."><meta property="og:description" content="Computes the Chapman-Robson estimates of annual survival rate (S) and instantaneous mortality rate (Z) from catch-at-age data on the descending limb of a catch-curve. Method functions extract estimates with associated standard errors and confidence intervals. A plot method highlights the descending-limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A."><meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Computing_PSDs.html">Computing Proportional Size Distribution Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Computing_Relative_Weights.html">Computing Relative Weights</a></li>
    <li><a class="dropdown-item" href="../articles/Fitting_Growth_Functions.html">Fitting Growth Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Growth_Starting_Values.html">Explaining Starting Values for Growth Functions</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto FSA home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA" aria-label="Goto FSA github page"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Computes Chapman-Robson estimates of S and Z.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/HEAD/R/chapmanRobson.R" class="external-link"><code>R/chapmanRobson.R</code></a></small>
      <div class="d-none name"><code>chapmanRobson.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the Chapman-Robson estimates of annual survival rate (S) and instantaneous mortality rate (Z) from catch-at-age data on the descending limb of a catch-curve. Method functions extract estimates with associated standard errors and confidence intervals. A plot method highlights the descending-limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">chapmanRobson</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">chapmanRobson</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">catch</span>,</span>
<span>  ages2use <span class="op">=</span> <span class="va">age</span>,</span>
<span>  zmethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Smithetal"</span>, <span class="st">"Hoenigetal"</span>, <span class="st">"original"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">chapmanRobson</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  ages2use <span class="op">=</span> <span class="va">age</span>,</span>
<span>  zmethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Smithetal"</span>, <span class="st">"Hoenigetal"</span>, <span class="st">"original"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'chapmanRobson'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"Z"</span>, <span class="st">"S"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'chapmanRobson'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"Z"</span>, <span class="st">"S"</span><span class="op">)</span>, as.df <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'chapmanRobson'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"S"</span>, <span class="st">"Z"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="va">conf.level</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  incl.est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'chapmanRobson'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pos.est <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  cex.est <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  round.est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Catch"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.pt <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>  axis.age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"age"</span>, <span class="st">"recoded age"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numerical vector of the assigned ages in the catch curve or a formula of the form <code>catch~age</code> when used in <code>chapmanRobson</code>. An object saved from <code>chapmanRobson</code> (i.e., of class <code>chapmanRobson</code>) when used in the methods.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for methods.</p></dd>


<dt id="arg-catch">catch<a class="anchor" aria-label="anchor" href="#arg-catch"></a></dt>
<dd><p>A numerical vector of the catches or CPUEs for the ages in the catch curve. Not used if <code>x</code> is a formula.</p></dd>


<dt id="arg-ages-use">ages2use<a class="anchor" aria-label="anchor" href="#arg-ages-use"></a></dt>
<dd><p>A numerical vector of the ages that define the descending limb of the catch curve.</p></dd>


<dt id="arg-zmethod">zmethod<a class="anchor" aria-label="anchor" href="#arg-zmethod"></a></dt>
<dd><p>A string that indicates the method to use for estimating Z. See details.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame from which the variables in the <code>x</code> formula can be found. Not used if <code>x</code> is not a formula.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object saved from the <code>chapmanRobson</code> call (i.e., of class <code>chapmanRobson</code>).</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>A numeric or string (of parameter names) vector that specifies which parameters are to be given confidence intervals  If missing, all parameters are considered.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical that indicates whether the method should return just the estimate (<code>FALSE</code>; default) or a more verbose statement.</p></dd>


<dt id="arg-as-df">as.df<a class="anchor" aria-label="anchor" href="#arg-as-df"></a></dt>
<dd><p>A logical that indicates whether the results of <code>coef</code>, <code>confint</code>, or <code>summary</code> should be returned as a data.frame. Ignored in <code>summary</code> if <code>parm="lm"</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Same as <code>conf.level</code>. Used for compatibility with the generic <code>confint</code> function.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>A number representing the level of confidence to use for constructing confidence intervals.</p></dd>


<dt id="arg-incl-est">incl.est<a class="anchor" aria-label="anchor" href="#arg-incl-est"></a></dt>
<dd><p>A logical that indicated whether the parameter point estimate should be included in the results from <code>confint</code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-pos-est">pos.est<a class="anchor" aria-label="anchor" href="#arg-pos-est"></a></dt>
<dd><p>A string to identify where to place the estimated mortality rates on the plot. Can be set to one of <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> or <code>"center"</code> for positioning the estimated mortality rates on the plot. Typically <code>"bottomleft"</code> (DEFAULT) and <code>"topright"</code> will be “out-of-the-way” placements. Set <code>pos.est</code> to <code>NULL</code> to remove the estimated mortality rates from the plot.</p></dd>


<dt id="arg-cex-est">cex.est<a class="anchor" aria-label="anchor" href="#arg-cex-est"></a></dt>
<dd><p>A single numeric character expansion value for the estimated mortality rates on the plot.</p></dd>


<dt id="arg-round-est">round.est<a class="anchor" aria-label="anchor" href="#arg-round-est"></a></dt>
<dd><p>A numeric that indicates the number of decimal place to which Z (first value) and S (second value) should be rounded. If only one value then it will be used for both Z and S.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>A label for the y-axis (<code>"Catch"</code> is the default).</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>A label for the x-axis (<code>"Age"</code> is the default).</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>A numeric for the limits of the y-axis. If <code>NULL</code> then will default to 0 or the lowest catch and a maximum of the maximum catch. If a single value then it will be the maximum of the y-axis. If two values then these will the minimum and maximum values of the y-axis.</p></dd>


<dt id="arg-col-pt">col.pt<a class="anchor" aria-label="anchor" href="#arg-col-pt"></a></dt>
<dd><p>A string that indicates the color of the plotted points.</p></dd>


<dt id="arg-axis-age">axis.age<a class="anchor" aria-label="anchor" href="#arg-axis-age"></a></dt>
<dd><p>A string that indicates the type of x-axis to display. The <code>age</code> will display only the original ages, <code>recoded age</code> will display only the recoded ages, and <code>both</code> (DEFAULT) displays the original ages on the main axis and the recoded ages on the secondary axis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following items:</p><ul><li><p>age the original vector of assigned ages.</p></li>
<li><p>catch the original vector of observed catches or CPUEs.</p></li>
<li><p>age.e a vector of assigned ages used to estimate mortalities.</p></li>
<li><p>catch.e a vector of catches or CPUEs used to estimate mortalities.</p></li>
<li><p>age.r a vector of recoded ages used to estimate mortalities. See references.</p></li>
<li><p>n a numeric holding the intermediate calculation of n. See references.</p></li>
<li><p>T a numeric holding the intermediate calculation of T. See references.</p></li>
<li><p>est A 2x2 matrix that contains the estimates and standard errors for S and Z.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default is to use all ages in the age vector. This is only appropriate if the age and catch vectors contain only the ages and catches on the descending limb of the catch curve. Use <code>ages2use</code> to isolate only the catch and ages on the descending limb.</p>
<p>The Chapman-Robson method provides an estimate of the annual survival rate, with the annual mortality rate (A) determined by 1-S. The instantaneous mortality rate is often computed as -log(S). However, Hoenig <em>et al.</em> (1983) showed that this produced a biased (over)estimate of Z and provided a correction. The correction is applied by setting <code>zmethod="Hoenigetal"</code>. Smith <em>et al.</em> (2012) showed that the Hoenig <em>et al.</em> method should be corrected for a variance inflation factor. This correction is applied by setting <code>zmethod="Smithetal"</code> (which is the default behavior). Choose <code>zmethod="original"</code> to use the original estimates for Z and it's SE as provided by Chapman and Robson.</p>
    </div>
    <div class="section level2">
    <h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
    <p>Tested the results of chapmanRobson against the results in Miranda and Bettoli (2007). The point estimates of S matched perfectly but the SE of S did not because Miranda and Bettoli used a rounded estimate of S in the calculation of the SE of S but chapmanRobson does not.</p>
<p>Tested the results against the results from <code>agesurv</code> in <span class="pkg">fishmethods</span> using the <code>rockbass</code> data.frame in <span class="pkg">fishmethods</span>. Results for Z and the SE of Z matched perfectly for non-bias-corrected results. The estimate of Z, but not the SE of Z, matched for the bias-corrected (following Smith <em>et al.</em> (2012)) results. <span class="pkg">FSA</span> uses equation 2 from Smith <em>et al.</em> (2012) whereas <span class="pkg">fishmethods</span> appears to use equation 5 from the same source to estimate the SE of Z.</p>
    </div>
    <div class="section level2">
    <h2 id="ifar-chapter">IFAR Chapter<a class="anchor" aria-label="anchor" href="#ifar-chapter"></a></h2>
    <p>11-Mortality.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ogle, D.H. 2016. <a href="https://fishr-core-team.github.io/fishR/pages/books.html#introductory-fisheries-analyses-with-r" class="external-link">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Chapman, D.G. and D.S. Robson. 1960. The analysis of a catch curve. Biometrics. 16:354-368.</p>
<p>Hoenig, J.M. and W.D. Lawing, and N.A. Hoenig. 1983. Using mean age, mean length and median length data to estimate the total mortality rate. International Council for the Exploration of the Sea, CM 1983/D:23, Copenhagen.</p>
<p>Ricker, W.E. 1975. Computation and interpretation of biological statistics of fish populations. Technical Report Bulletin 191, Bulletin of the Fisheries Research Board of Canada. [Was (is?) from http://www.dfo-mpo.gc.ca/Library/1485.pdf.]</p>
<p>Robson, D.S. and D.G. Chapman. 1961. Catch curves and mortality rates. Transactions of the American Fisheries Society. 90:181-189.</p>
<p>Smith, M.W., A.Y. Then, C. Wor, G. Ralph, K.H. Pollock, and J.M. Hoenig. 2012. Recommendations for catch-curve analysis. North American Journal of Fisheries Management. 32:956-967.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="https://rdrr.io/pkg/fishmethods/man/agesurv.html" class="external-link">agesurv</a></code> in <span class="pkg">fishmethods</span> for similar functionality. See <code><a href="catchCurve.html">catchCurve</a></code> and <code><a href="https://rdrr.io/pkg/fishmethods/man/agesurvcl.html" class="external-link">agesurvcl</a></code> in <span class="pkg">fishmethods</span> for alternative methods. See <code><a href="metaM.html">metaM</a></code> for empirical methods to estimate natural mortality.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Derek H. Ogle, <a href="mailto:DerekOgle51@gmail.com">DerekOgle51@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chapmanRobson-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of formula notation</span></span></span>
<span class="r-in"><span><span class="va">cr1</span> <span class="op">&lt;-</span> <span class="fu">chapmanRobson</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,ages2use<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 49.4600432  2.3260749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.7018264  0.1153428</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr1</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Intermediate statistics: n=235; T=229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 49.4600432  2.3260749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.7018264  0.1153428</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cr1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          S          Z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49.4600432  0.7018264 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cr1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      95% LCI    95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 44.9010202 54.0190662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.4757586  0.9278941</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cr1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Est    95% LCI    95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 49.4600432 44.9010202 54.0190662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.7018264  0.4757586  0.9278941</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cr1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chapmanRobson-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cr1</span>,axis.age<span class="op">=</span><span class="st">"age"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chapmanRobson-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cr1</span>,axis.age<span class="op">=</span><span class="st">"recoded age"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chapmanRobson-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr1</span>,parm<span class="op">=</span><span class="st">"Z"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.7018264  0.1153428</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cr1</span>,parm<span class="op">=</span><span class="st">"Z"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Z </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7018264 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cr1</span>,parm<span class="op">=</span><span class="st">"Z"</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Est   95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.7018264 0.4757586 0.9278941</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of excluding ages2use</span></span></span>
<span class="r-in"><span><span class="va">cr2</span> <span class="op">&lt;-</span> <span class="fu">chapmanRobson</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,ages2use<span class="op">=</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 49.4600432  2.3260749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.7018264  0.1153428</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cr2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chapmanRobson-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of ability to work with missing age classes</span></span></span>
<span class="r-in"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ct</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">92</span>,<span class="fl">83</span>,<span class="fl">71</span>,<span class="fl">56</span>,<span class="fl">35</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cr3</span> <span class="op">&lt;-</span> <span class="fu">chapmanRobson</span><span class="op">(</span><span class="va">age</span>,<span class="va">ct</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 63.2683658  1.8679976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.4569234  0.1465991</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cr3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="chapmanRobson-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Demonstration of computation for multiple groups</span></span></span>
<span class="r-in"><span><span class="co">##   only ages on the descending limb for each group are in the data.frame</span></span></span>
<span class="r-in"><span><span class="co"># Get example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FHCatfish</span>,package<span class="op">=</span><span class="st">"FSAdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">FHCatfish</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       river age abundance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Coosa   2        25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Coosa   3        24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Coosa   4        18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Coosa   5        17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Coosa   6        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     Coosa   7        14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     Coosa   8         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     Coosa   9        10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     Coosa  10        15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Coosa  11         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Coosa  12        11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Coosa  13        10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Coosa  14         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Coosa  15         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Coosa  16         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Coosa  17         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Coosa  18         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Coosa  20         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Coosa  25         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Ocmulgee   2        32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 Ocmulgee   3        15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 Ocmulgee   4        13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 Ocmulgee   5         8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 Ocmulgee   6         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 Ocmulgee   7        11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 Ocmulgee   8         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 Ocmulgee   9         8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 Ocmulgee  10         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 Ocmulgee  11         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Ocmulgee  12         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Ocmulgee  13         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Ocmulgee  16         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  Satilla   2        94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  Satilla   3        77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  Satilla   4        36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  Satilla   5         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  Satilla   6         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  Satilla   7         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  Satilla  10         1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note use of incl.est=TRUE and as.df=TRUE</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">FHCatfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">river</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">chapmanRobson</span><span class="op">(</span><span class="va">abundance</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">.x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      river        S    S_LCI    S_UCI         Z     Z_LCI     Z_UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Coosa 83.76623 81.70625 85.82621 0.1769846 0.1291486 0.2248206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Ocmulgee 74.20147 69.94560 78.45735 0.2975508 0.2315192 0.3635824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Satilla 44.90862 39.92065 49.89658 0.7973861 0.4608940 1.1338782</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Demonstration of computation for multiple groups</span></span></span>
<span class="r-in"><span><span class="co">##   ages not on descending limb are in the data.frame, but use same</span></span></span>
<span class="r-in"><span><span class="co">##     ages.use= for each group</span></span></span>
<span class="r-in"><span><span class="co"># Get example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">WalleyeKS</span>,package<span class="op">=</span><span class="st">"FSAdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note use of incl.est=TRUE and as.df=TRUE</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">WalleyeKS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">reservoir</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">chapmanRobson</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">.x</span>,ages2use<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reservoir        S    S_LCI    S_UCI         Z     Z_LCI     Z_UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Cedar.Bluff 46.92308 41.96379 51.88237 0.7538037 0.6615871 0.8460203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Cheney 53.47432 48.09274 58.85590 0.6233886 0.1617918 1.0849854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Glen.Elder 45.06713 42.71023 47.42404 0.7963078 0.6651496 0.9274661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Kirwin 39.04110 31.10067 46.98152 0.9302788 0.7316175 1.1289400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    Lovewell 58.62069 55.71150 61.52988 0.5334457 0.2137564 0.8531351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Marion 59.19679 56.46571 61.92787 0.5237522 0.3083083 0.7391961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     Webster 57.73196 50.76275 64.70117 0.5457089 0.3605679 0.7308498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Wilson 47.08249 42.68974 51.47525 0.7510342 0.5833127 0.9187556</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://derekogle.com" class="external-link">Derek H. Ogle</a>, Jason C. Doll, A. Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

