<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Population estimates for k-, 3-, or 2-pass removal data. — removal • FSA</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Population estimates for k-, 3-, or 2-pass removal data. — removal"><meta name="description" content="Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population."><meta property="og:description" content="Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population."><meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Computing_PSDs.html">Computing Proportional Size Distribution Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Computing_Relative_Weights.html">Computing Relative Weights</a></li>
    <li><a class="dropdown-item" href="../articles/Fitting_Growth_Functions.html">Fitting Growth Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Growth_Starting_Values.html">Explaining Starting Values for Growth Functions</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto FSA home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA" aria-label="Goto FSA github page"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Population estimates for k-, 3-, or 2-pass removal data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/HEAD/R/removal.R" class="external-link"><code>R/removal.R</code></a></small>
      <div class="d-none name"><code>removal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">removal</span><span class="op">(</span><span class="va">catch</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">removal</span><span class="op">(</span></span>
<span>  <span class="va">catch</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CarleStrub"</span>, <span class="st">"Zippin"</span>, <span class="st">"Seber3"</span>, <span class="st">"Seber2"</span>, <span class="st">"RobsonRegier2"</span>, <span class="st">"Moran"</span>,</span>
<span>    <span class="st">"Schnute"</span>, <span class="st">"Burnham"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  CS.se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zippin"</span>, <span class="st">"alternative"</span><span class="op">)</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  Tmult <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  CIMicroFish <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">removal</span><span class="op">(</span></span>
<span>  <span class="va">catch</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CarleStrub"</span>, <span class="st">"Zippin"</span>, <span class="st">"Seber3"</span>, <span class="st">"Seber2"</span>, <span class="st">"RobsonRegier2"</span>, <span class="st">"Moran"</span>,</span>
<span>    <span class="st">"Schnute"</span>, <span class="st">"Burnham"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  CS.se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zippin"</span>, <span class="st">"alternative"</span><span class="op">)</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  Tmult <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  CIMicroFish <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  just.ests <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'removal'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"No"</span>, <span class="st">"p"</span>, <span class="st">"p1"</span><span class="op">)</span>, as.df <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'removal'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"No"</span>, <span class="st">"p"</span>, <span class="st">"p1"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="va">conf.level</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  incl.est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'removal'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"No"</span>, <span class="st">"p"</span>, <span class="st">"p1"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-catch">catch<a class="anchor" aria-label="anchor" href="#arg-catch"></a></dt>
<dd><p>A numerical vector of catch at each pass, or a formula of the form <code>~catch</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for methods.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame from which the variables in the <code>catch</code> formula can be found. Not used if <code>catch</code> is not a formula.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A single string that identifies the removal method to use. See details.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A single numeric value for the alpha parameter in the CarleStrub method (default is <code>1</code>).</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>A single numeric value for the beta parameter in the CarleStrub method (default is <code>1</code>).</p></dd>


<dt id="arg-cs-se">CS.se<a class="anchor" aria-label="anchor" href="#arg-cs-se"></a></dt>
<dd><p>A single string that identifies whether the SE in the CarleStrub method should be computed according to Seber or Zippin.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>A single number representing the level of confidence to use for constructing confidence intervals. This is sent in the main <code>removal</code> function rather than <code>confint</code>.</p></dd>


<dt id="arg-tmult">Tmult<a class="anchor" aria-label="anchor" href="#arg-tmult"></a></dt>
<dd><p>A single numeric that will be multiplied by the total catch in all samples to set the upper value for the range of population sizes when minimizing the log-likelihood and creating confidence intervals for the Moran and Schnute methods. Large values are much slower to compute, but values that are too low may result in missing the best estimate. A warning is issued if too low of a value is suspected.</p></dd>


<dt id="arg-cimicrofish">CIMicroFish<a class="anchor" aria-label="anchor" href="#arg-cimicrofish"></a></dt>
<dd><p>A logical that indicates whether the t value used to calculate confidence intervals when <code>method="Burnham"</code> should be rounded to two or three decimals and whether the confidence intervals for No should be rounded to whole numbers as done in MicroFish 3.0. The default (<code>=FALSE</code>) is to NOT round the t values or No confidence interval. This option is provided only so that results will exactly match MicroFish results (see testing).</p></dd>


<dt id="arg-just-ests">just.ests<a class="anchor" aria-label="anchor" href="#arg-just-ests"></a></dt>
<dd><p>Deprecated as of v0.9.6. This was primarily used when using <code>removal</code> with a split-and-apply approach to estimate N for multiple groups. See examples and use of <code>incl.ests=</code> in <code>confint</code> for similar functionality.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object saved from <code>removal()</code>.</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>A specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p></dd>


<dt id="arg-as-df">as.df<a class="anchor" aria-label="anchor" href="#arg-as-df"></a></dt>
<dd><p>A logical that indicates whether the results of <code>coef</code>, <code>confint</code>, or <code>summary</code> should be returned as a data.frame. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Not used, but here for compatibility with generic <code>confint</code> function.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>A single numeric that controls the number of decimals in the output from <code>summary</code> and <code>confint</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical that indicates whether descriptive labels should be printed from <code>summary</code> and if certain warnings are shown with <code>confint</code>.</p></dd>


<dt id="arg-incl-est">incl.est<a class="anchor" aria-label="anchor" href="#arg-incl-est"></a></dt>
<dd><p>A logical that indicated whether the parameter point estimate should be included in the results from <code>confint</code>. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with at least the following items:</p><ul><li><p>catch The original vector of observed catches.</p></li>
<li><p>method The method used (provided by the user).</p></li>
<li><p>lbl A descriptive label for the method used.</p></li>
<li><p>est A matrix that contains the estimates and standard errors for No and p.</p></li>
</ul><p>In addition, if the Moran or Schnute methods are used the list will also contain</p><ul><li><p>min.nlogLH The minimum value of the negative log-likelihood function.</p></li>
<li><p>Tmult The Tmult value sent by the user.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The main function computes the estimates and associated standard errors, if possible, for the initial population size, No, and probability of capture, p, for eight methods chosen with <code>method=</code>. The possible methods are:</p><ul><li><p><code>method="CarleStrub"</code>: The general weighted k-pass estimator proposed by Carle and Strub (1978). This function iteratively solves for No in equation 7 of Carle and Strub (1978).</p></li>
<li><p><code>method="Zippin"</code>: The general k-pass estimator generally attributed to Zippin. This function iteratively solves for No in bias corrected version of equation 3 (page 622) of Carle and Strub (1978). These results are not yet trustworthy (see Testing section below).</p></li>
<li><p><code>method="Seber3"</code>: The special case for k=3 estimator shown in equation 7.24 of Seber(2002).</p></li>
<li><p><code>method="Seber2"</code>: The special case for k=2 estimator shown on page 312 of Seber(2002).</p></li>
<li><p><code>method="RobsonRegier2"</code>: The special case for k=2 estimator shown by Robson and Regier (1968).</p></li>
<li><p><code>method="Moran"</code>: The likelihood method of Moran (1951) as implemented by Schnute (1983).</p></li>
<li><p><code>method="Schnute"</code>: The likelihood method of Schnute (1983) for the model that has a different probability of capture for the first sample but a constant probability of capture for all ensuing samples.</p></li>
<li><p><code>method="Burnham"</code>: The general k-pass estimator likelihood method created by Ken Burnham and presented by Van Deventer and Platts (1983). This method is used in the Microfish software (Van Deventer 1989).</p></li>
</ul><p>Confidence intervals for the first five methods are computed using standard large-sample normal distribution theory. Note that the confidence intervals for the 2- and 3-pass special cases are only approximately correct if the estimated population size is greater than 200. If the estimated population size is between 50 and 200 then a 95% CI behaves more like a 90% CI.</p>
<p>Confidence intervals for the next two methods use likelihood ratio theory as described in Schnute (1983) and are only produced for the No parameter. Standard errors are not produced with the Moran or Schnute methods.</p>
<p>Confidence intervals for the last method are computed as per Ken Burnham's instructions for the Burnham Method (Jack Van Deventer, personal communication). Specifically, they are calculated with the t-statistic and No-1 degrees of freedom. Please note that the MicroFish software rounds the t-statistic before it calculates the confidence intervals about No and p. If you need the confidence interals produced by FSA::removal to duplicate MicroFish, please use CIMicroFish=TRUE.</p>
    </div>
    <div class="section level2">
    <h2 id="testing">testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
    <p>The Carle-Strub method matches the examples in Carle and Strub (1978) for No, p, and the variance of No. The Carle-Strub estimates of No and p match the examples in Cowx (1983) but the SE of No does not. The Carle-Strub estimates of No match the results (for estimates that they did not reject) from Jones and Stockwell (1995) to within 1 individual in most instances and within 1% for all other instances (e.g., off by 3 individuals when the estimate was 930 individuals).</p>
<p>The Seber3 results for No match the results in Cowx (1983).</p>
<p>The Seber2 results for No, p, and the SE of No match the results in example 7.4 of Seber (2002) and in Cowx (1983).</p>
<p>The RobsonRegier2 results for No and the SE of NO match the results in Cowx (1983)</p>
<p>The Zippin method results do not match the examples in Seber (2002) or Cowx (1983) because <code>removal</code> uses the bias-corrected version from Carle and Strub (1978) and does not use the tables in Zippin (1958). The Zippin method is not yet trustworthy.</p>
<p>The Moran and Schnute methods match the examples in Schnute (1983) perfectly for all point estimates and within 0.1 units for all confidence intervals.</p>
<p>The Burnham method was tested against the free (gratis) Demo Version of MicroFish 3.0. Powell Wheeler used R to simulate 100, three-pass removal samples with capture probabilities between 0 and 1 and population sizes &lt;= 1000. The Burnham method implemented here exactly matched MicroFish in all 100 trials for No and p. In addition, the CIs for No exactly matched all 100 trials when CIMicroFish=TRUE. Powell was not able to check the CIs for p because the MicroFish 'Quick Population Estimate' does not report them.</p>
    </div>
    <div class="section level2">
    <h2 id="ifar-chapter">IFAR Chapter<a class="anchor" aria-label="anchor" href="#ifar-chapter"></a></h2>
    <p>10-Abundance from Depletion Data.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ogle, D.H. 2016. <a href="https://fishr-core-team.github.io/fishR/pages/books.html#introductory-fisheries-analyses-with-r" class="external-link">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Carle, F.L. and M.R. Strub. 1978. A new method for estimating population size from removal data. Biometrics, 34:621-630.</p>
<p>Cowx, I.G. 1983. Review of the methods for estimating fish population size from survey removal data. Fisheries Management, 14:67-82.</p>
<p>Moran, P.A.P. 1951. A mathematical theory of animal trapping. Biometrika 38:307-311.</p>
<p>Robson, D.S., and H.A. Regier. 1968. Estimation of population number and mortality rates. pp. 124-158 in Ricker, W.E. (editor) Methods for Assessment of Fish Production in Fresh Waters. IBP Handbook NO. 3 Blackwell Scientific Publications, Oxford.</p>
<p>Schnute, J. 1983. A new approach to estimating populations by the removal method. Canadian Journal of Fisheries and Aquatic Sciences, 40:2153-2169.</p>
<p>Seber, G.A.F. 2002. The Estimation of Animal Abundance. Edward Arnold, second edition (Reprint).</p>
<p>van Dishoeck, P. 2009. Effects of catchability variation on performance of depletion estimators: Application to an adaptive management experiment. Masters Thesis, Simon Fraser University. [Was (is?) from http://rem-main.rem.sfu.ca/theses/vanDishoeckPier_2009_MRM483.pdf.]</p>
<p>Van Deventer, J.S. 1989. Microcomputer Software System for Generating Population Statistics from Electrofishing Data–User's Guide for MicroFish 3.0. USDA Forest Service, General Technical Report INT-254. 29 p. [Was (is?) from https://relicensing.pcwa.net/documents/Library/PCWA-L<!-- %20460.pdf]. --></p>
<p>Van Deventer, J.S., and W.S. Platts. 1983. Sampling and estimating fish populations from streams. Transactions of the 48th North American Wildlife and Natural Resource Conference. pp. 349-354.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="depletion.html">depletion</a></code> for related functionality.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Derek H. Ogle, <a href="mailto:DerekOgle51@gmail.com">DerekOgle51@gmail.com</a></p>
<p>A. Powell Wheeler, <a href="mailto:powell.wheeler@gmail.com">powell.wheeler@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## First example -- 3 passes</span></span></span>
<span class="r-in"><span><span class="va">ct3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77</span>,<span class="fl">50</span>,<span class="fl">37</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Carle Strub (default) method</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 233.0000000 31.3578504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Carle &amp; Strub (1978) K-Pass Removal Method was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 233.0000000 31.3578504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No      233   31.35785</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.5397426 294.4602574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.2006195   0.4620067</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI  95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.5397 294.4603</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.2006195 0.4620067</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Moran method</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span>,method<span class="op">=</span><span class="st">"Moran"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p2</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Moran (1951) K-Pass Removal Method was used (SEs not computed).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 237.5965440         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3223336         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p2</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence intervals for 'p' can not be computed for Moran method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    95% LCI 95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No   194.7   370.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p       NA      NA</span>
<span class="r-in"><span><span class="co">#'</span></span></span>
<span class="r-in"><span><span class="co"># Schnute method</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span>,method<span class="op">=</span><span class="st">"Schnute"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p3</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Schnute (1983) K-Pass Removal Method w/ Non-constant Initial Catchability was used (SEs not computed).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 245.0955550         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3039927         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1   0.3141632         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p3</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> An upper confidence value for 'No' cannot be determined.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence intervals for 'p' can not be computed for Schnute method.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Confidence intervals for 'p1' can not be computed for Schnute method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    95% LCI 95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No   183.9     Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p       NA      NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1      NA      NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Burnham method</span></span></span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span>,method<span class="op">=</span><span class="st">"Burnham"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 238.0000000 33.8404319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3215686  0.0673948</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Burnham K-Pass Removal Method (Van Deventer and Platts 1983) was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 238.0000000 33.8404319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3215686  0.0673948</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No      238   33.84043</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.3215686  0.0673948</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.3335366 304.6664634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.1887992   0.4543381</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI  95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.3335 304.6665</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.1887992 0.4543381</span>
<span class="r-in"><span><span class="co">## Second example -- 2 passes</span></span></span>
<span class="r-in"><span><span class="va">ct2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77</span>,<span class="fl">37</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Seber method</span></span></span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct2</span>,method<span class="op">=</span><span class="st">"Seber2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Seber (2002) 2-Pass Removal Method was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 148.2250000 19.0118725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.5194805  0.0961208</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 110.9624147 185.4875853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3310873   0.7078737</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use formula with a data.frame</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ct<span class="op">=</span><span class="va">ct3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1a</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="op">~</span><span class="va">ct</span>,data<span class="op">=</span><span class="va">d</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1a</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Carle &amp; Strub (1978) K-Pass Removal Method was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 233.0000000 31.3578504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1a</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Est     95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 233.0000000 171.5397426 294.4602574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3313131   0.2006195   0.4620067</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Test if catchability differs between first sample and the other samples</span></span></span>
<span class="r-in"><span><span class="co"># chi-square test statistic from  negative log-likelihoods</span></span></span>
<span class="r-in"><span><span class="co">#   from Moran and Schnute fits (from above)</span></span></span>
<span class="r-in"><span><span class="va">chi2.val</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">p2</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">-</span><span class="va">p3</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># p-value ... no significant difference</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">chi2.val</span>,df<span class="op">=</span><span class="fl">1</span>,lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8882765</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Another LRT example ... sample 1 from Schnute (1983)</span></span></span>
<span class="r-in"><span><span class="va">ct4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">11</span>,<span class="fl">18</span>,<span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2a</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct4</span>,method<span class="op">=</span><span class="st">"Moran"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3a</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct4</span>,method<span class="op">=</span><span class="st">"Schnute"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chi2.val</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">p2a</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">-</span><span class="va">p3a</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">)</span>  <span class="co"># 4.74 in Schnute(1983)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">chi2.val</span>,df<span class="op">=</span><span class="fl">1</span>,lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>         <span class="co"># sig diff (catchability differs)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02955309</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p3a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 123.5879686         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.1890032         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1   0.3641131         NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demonstrate multiple groups ... data in long format</span></span></span>
<span class="r-in"><span><span class="co">## create a dummy data frame</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lake<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ash Tree"</span>,<span class="st">"Bark"</span>,<span class="st">"Clay"</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2010"</span>,<span class="st">"2011"</span>,<span class="st">"2010"</span>,<span class="st">"2011"</span>,<span class="st">"2010"</span>,<span class="st">"2011"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                pass<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                catch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">57</span>,<span class="fl">34</span>,<span class="fl">65</span>,<span class="fl">34</span>,<span class="fl">12</span>,<span class="fl">54</span>,<span class="fl">26</span>,<span class="fl">9</span>,<span class="fl">54</span>,<span class="fl">27</span>,<span class="fl">67</span>,<span class="fl">34</span>,<span class="fl">68</span>,<span class="fl">35</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lake year pass catch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Ash Tree 2010    1    57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Ash Tree 2010    2    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Ash Tree 2011    1    65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Ash Tree 2011    2    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Ash Tree 2011    3    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Bark 2010    1    54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Bark 2010    2    26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Bark 2010    3     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Bark 2011    1    54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     Bark 2011    2    27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     Clay 2010    1    67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     Clay 2010    2    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     Clay 2011    1    68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     Clay 2011    2    35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     Clay 2011    3    12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## note use of confint with incl.est= and as.df=</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="op">&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">lake</span>,<span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">removal</span><span class="op">(</span><span class="op">~</span><span class="va">catch</span>,data<span class="op">=</span><span class="va">.x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html" class="external-link">separate_wider_delim</a></span><span class="op">(</span><span class="fl">1</span>,names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lake"</span>,<span class="st">"year"</span><span class="op">)</span>,delim<span class="op">=</span><span class="st">"."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: tidyr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lake year  No    No.LCI   No.UCI         p     p.LCI     p.UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Ash Tree 2010 130  78.82817 181.1718 0.4482759 0.2107166 0.6858351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Bark 2010  95  86.67469 103.3253 0.5894040 0.4636055 0.7152024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Clay 2010 130  95.80615 164.1938 0.5233161 0.3239490 0.7226831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Ash Tree 2011 121 109.68805 132.3120 0.5577889 0.4398676 0.6757103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Bark 2011 103  74.06990 131.9301 0.5328947 0.3138934 0.7518961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     Clay 2011 125 113.89427 136.1057 0.5637255 0.4489247 0.6785262</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demonstrate multiple groups ... data in wide format</span></span></span>
<span class="r-in"><span><span class="co">## create a dummy data frame ... same data as previous ... note that this is</span></span></span>
<span class="r-in"><span><span class="co">##   not an efficient way to enter data, used here just for simple example</span></span></span>
<span class="r-in"><span><span class="va">d2w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lake<span class="op">=</span><span class="st">"Ash Tree"</span>,year<span class="op">=</span><span class="fl">2011</span>,pass1<span class="op">=</span><span class="fl">65</span>,pass2<span class="op">=</span><span class="fl">34</span>,pass3<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lake<span class="op">=</span><span class="st">"Bark"</span>,year<span class="op">=</span><span class="fl">2010</span>,pass1<span class="op">=</span><span class="fl">54</span>,pass2<span class="op">=</span><span class="fl">26</span>,pass3<span class="op">=</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lake<span class="op">=</span><span class="st">"Bark"</span>,year<span class="op">=</span><span class="fl">2011</span>,pass1<span class="op">=</span><span class="fl">54</span>,pass2<span class="op">=</span><span class="fl">27</span>,pass3<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lake<span class="op">=</span><span class="st">"Clay"</span>,year<span class="op">=</span><span class="fl">2010</span>,pass1<span class="op">=</span><span class="fl">67</span>,pass2<span class="op">=</span><span class="fl">34</span>,pass3<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>lake<span class="op">=</span><span class="st">"Clay"</span>,year<span class="op">=</span><span class="fl">2011</span>,pass1<span class="op">=</span><span class="fl">68</span>,pass2<span class="op">=</span><span class="fl">35</span>,pass3<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2w</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lake year pass1 pass2 pass3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Ash Tree 2011    65    34    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Bark 2010    54    26     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Bark 2011    54    27    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Clay 2010    67    34    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Clay 2011    68    35    12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## convert to long format first</span></span></span>
<span class="r-in"><span><span class="va">d2l</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">d2w</span>,cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pass1"</span>,<span class="st">"pass2"</span>,<span class="st">"pass3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           names_to<span class="op">=</span><span class="st">"pass"</span>,values_to<span class="op">=</span><span class="st">"catch"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2l</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 15 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lake      year pass  catch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> Ash Tree  <span style="text-decoration: underline;">2</span>011 pass1    65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> Ash Tree  <span style="text-decoration: underline;">2</span>011 pass2    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> Ash Tree  <span style="text-decoration: underline;">2</span>011 pass3    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> Bark      <span style="text-decoration: underline;">2</span>010 pass1    54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> Bark      <span style="text-decoration: underline;">2</span>010 pass2    26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> Bark      <span style="text-decoration: underline;">2</span>010 pass3     9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> Bark      <span style="text-decoration: underline;">2</span>011 pass1    54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> Bark      <span style="text-decoration: underline;">2</span>011 pass2    27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> Bark      <span style="text-decoration: underline;">2</span>011 pass3    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> Clay      <span style="text-decoration: underline;">2</span>010 pass1    67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> Clay      <span style="text-decoration: underline;">2</span>010 pass2    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> Clay      <span style="text-decoration: underline;">2</span>010 pass3    <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> Clay      <span style="text-decoration: underline;">2</span>011 pass1    68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> Clay      <span style="text-decoration: underline;">2</span>011 pass2    35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> Clay      <span style="text-decoration: underline;">2</span>011 pass3    12</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## then same process as previous example</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res2</span> <span class="op">&lt;-</span> <span class="va">d2l</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">lake</span>,<span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">removal</span><span class="op">(</span><span class="op">~</span><span class="va">catch</span>,data<span class="op">=</span><span class="va">.x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_wider_delim.html" class="external-link">separate_wider_delim</a></span><span class="op">(</span><span class="fl">1</span>,names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lake"</span>,<span class="st">"year"</span><span class="op">)</span>,delim<span class="op">=</span><span class="st">"."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'NA's removed from 'catch' to continue.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'NA's removed from 'catch' to continue.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lake year  No    No.LCI   No.UCI         p     p.LCI     p.UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Bark 2010  95  86.67469 103.3253 0.5894040 0.4636055 0.7152024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Clay 2010 130  95.80615 164.1938 0.5233161 0.3239490 0.7226831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Ash Tree 2011 121 109.68805 132.3120 0.5577889 0.4398676 0.6757103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Bark 2011 103  74.06990 131.9301 0.5328947 0.3138934 0.7518961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Clay 2011 125 113.89427 136.1057 0.5637255 0.4489247 0.6785262</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://derekogle.com" class="external-link">Derek H. Ogle</a>, Jason C. Doll, A. Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

