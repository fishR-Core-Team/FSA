<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population."><title>Population estimates for k-, 3-, or 2-pass removal data. — removal • FSA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Population estimates for k-, 3-, or 2-pass removal data. — removal"><meta property="og:description" content="Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population."><meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA">
    <span class="fa fa-github fa"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Population estimates for k-, 3-, or 2-pass removal data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/HEAD/R/removal.R" class="external-link"><code>R/removal.R</code></a></small>
      <div class="d-none name"><code>removal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes estimates, with confidence intervals, of the population size and probability of capture from the number of fish removed in k-, 3-, or 2-passes in a closed population.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">removal</span><span class="op">(</span></span>
<span>  <span class="va">catch</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CarleStrub"</span>, <span class="st">"Zippin"</span>, <span class="st">"Seber3"</span>, <span class="st">"Seber2"</span>, <span class="st">"RobsonRegier2"</span>, <span class="st">"Moran"</span>,</span>
<span>    <span class="st">"Schnute"</span>, <span class="st">"Burnham"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  CS.se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Zippin"</span>, <span class="st">"alternative"</span><span class="op">)</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  just.ests <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Tmult <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  CIMicroFish <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for removal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"p"</span>, <span class="st">"p1"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for removal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="va">conf.level</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>catch</dt>
<dd><p>A numerical vector of catch at each pass.</p></dd>


<dt>method</dt>
<dd><p>A single string that identifies the removal method to use. See details.</p></dd>


<dt>alpha</dt>
<dd><p>A single numeric value for the alpha parameter in the CarleStrub method (default is <code>1</code>).</p></dd>


<dt>beta</dt>
<dd><p>A single numeric value for the beta parameter in the CarleStrub method (default is <code>1</code>).</p></dd>


<dt>CS.se</dt>
<dd><p>A single string that identifies whether the SE in the CarleStrub method should be computed according to Seber or Zippin.</p></dd>


<dt>conf.level</dt>
<dd><p>A single number representing the level of confidence to use for constructing confidence intervals. This is sent in the main <code>removal</code> function rather than <code>confint</code>.</p></dd>


<dt>just.ests</dt>
<dd><p>A logical that indicates whether just the estimates (<code>=TRUE</code>) or the return list (<code>=FALSE</code>; default; see below) is returned.</p></dd>


<dt>Tmult</dt>
<dd><p>A single numeric that will be multiplied by the total catch in all samples to set the upper value for the range of population sizes when minimizing the log-likelihood and creating confidence intervals for the Moran and Schnute methods. Large values are much slower to compute, but values that are too low may result in missing the best estimate. A warning is issued if too low of a value is suspected.</p></dd>


<dt>CIMicroFish</dt>
<dd><p>A logical that indicates whether the t value used to calculate confidence intervals when <code>method="Burnham"</code> should be rounded to two or three decimals and whether the confidence intervals for No should be rounded to whole numbers as done in MicroFish 3.0. The default (<code>=FALSE</code>) is to NOT round the t values or No confidence interval. This option is provided only so that results will exactly match MicroFish results (see testing).</p></dd>


<dt>object</dt>
<dd><p>An object saved from <code>removal()</code>.</p></dd>


<dt>parm</dt>
<dd><p>A specification of which parameters are to be given confidence intervals, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p></dd>


<dt>digits</dt>
<dd><p>A single numeric that controls the number of decimals in the output from <code>summary</code> and <code>confint</code>.</p></dd>


<dt>verbose</dt>
<dd><p>A logical that indicates whether descriptive labels should be printed from <code>summary</code> and if certain warnings are shown with <code>confint</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments for methods.</p></dd>


<dt>level</dt>
<dd><p>Not used, but here for compatibility with generic <code>confint</code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A vector that contains the estimates and standard errors for No and p if <code>just.ests=TRUE</code> or (default) a list with at least the following items:</p>
<p></p>
<ul><li><p>catch The original vector of observed catches.</p></li>
<li><p>method The method used (provided by the user).</p></li>
<li><p>lbl A descriptive label for the method used.</p></li>
<li><p>est A matrix that contains the estimates and standard errors for No and p.</p></li>
</ul><p>In addition, if the Moran or Schnute methods are used the list will also contain</p>
<p></p>
<ul><li><p>min.nlogLH The minimum value of the negative log-likelihood function.</p></li>
<li><p>Tmult The Tmult value sent by the user.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The main function computes the estimates and associated standard errors, if possible, for the initial population size, No, and probability of capture, p, for eight methods chosen with <code>method=</code>. The possible methods are:</p><ul><li><p><code>method="CarleStrub"</code>: The general weighted k-pass estimator proposed by Carle and Strub (1978). This function iteratively solves for No in equation 7 of Carle and Strub (1978).</p></li>
<li><p><code>method="Zippin"</code>: The general k-pass estimator generally attributed to Zippin. This function iteratively solves for No in bias corrected version of equation 3 (page 622) of Carle and Strub (1978). These results are not yet trustworthy (see Testing section below).</p></li>
<li><p><code>method="Seber3"</code>: The special case for k=3 estimator shown in equation 7.24 of Seber(2002).</p></li>
<li><p><code>method="Seber2"</code>: The special case for k=2 estimator shown on page 312 of Seber(2002).</p></li>
<li><p><code>method="RobsonRegier2"</code>: The special case for k=2 estimator shown by Robson and Regier (1968).</p></li>
<li><p><code>method="Moran"</code>: The likelihood method of Moran (1951) as implemented by Schnute (1983).</p></li>
<li><p><code>method="Schnute"</code>: The likelihood method of Schnute (1983) for the model that has a different probability of capture for the first sample but a constant probability of capture for all ensuing samples.</p></li>
<li><p><code>method="Burnham"</code>: The general k-pass estimator likelihood method created by Ken Burnham and presented by Van Deventer and Platts (1983). This method is used in the Microfish software (Van Deventer 1989).</p></li>
</ul><p>Confidence intervals for the first five methods are computed using standard large-sample normal distribution theory. Note that the confidence intervals for the 2- and 3-pass special cases are only approximately correct if the estimated population size is greater than 200. If the estimated population size is between 50 and 200 then a 95% CI behaves more like a 90% CI.</p>
<p>Confidence intervals for the next two methods use likelihood ratio theory as described in Schnute (1983) and are only produced for the No parameter. Standard errors are not produced with the Moran or Schnute methods.</p>
<p>Confidence intervals for the last method are computed as per Ken Burnham's instructions for the Burnham Method (Jack Van Deventer, personal communication). Specifically, they are calculated with the t-statistic and No-1 degrees of freedom. Please note that the MicroFish software rounds the t-statistic before it calculates the confidence intervals about No and p. If you need the confidence interals produced by FSA::removal to duplicate MicroFish, please use CIMicroFish=TRUE.</p>
    </div>
    <div class="section level2">
    <h2 id="testing">testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
    <p>The Carle-Strub method matches the examples in Carle and Strub (1978) for No, p, and the variance of No. The Carle-Strub estimates of No and p match the examples in Cowx (1983) but the SE of No does not. The Carle-Strub estimates of No match the results (for estimates that they did not reject) from Jones and Stockwell (1995) to within 1 individual in most instances and within 1% for all other instances (e.g., off by 3 individuals when the estimate was 930 individuals).</p>
<p>The Seber3 results for No match the results in Cowx (1983).</p>
<p>The Seber2 results for No, p, and the SE of No match the results in example 7.4 of Seber (2002) and in Cowx (1983).</p>
<p>The RobsonRegier2 results for No and the SE of NO match the results in Cowx (1983)</p>
<p>The Zippin method results do not match the examples in Seber (2002) or Cowx (1983) because <code>removal</code> uses the bias-corrected version from Carle and Strub (1978) and does not use the tables in Zippin (1958). The Zippin method is not yet trustworthy.</p>
<p>The Moran and Schnute methods match the examples in Schnute (1983) perfectly for all point estimates and within 0.1 units for all confidence intervals.</p>
<p>The Burnham method was tested against the free (gratis) Demo Version of MicroFish 3.0. Powell Wheeler used R to simulate 100, three-pass removal samples with capture probabilities between 0 and 1 and population sizes &lt;= 1000. The Burnham method implemented here exactly matched MicroFish in all 100 trials for No and p. In addition, the CIs for No exactly matched all 100 trials when CIMicroFish=TRUE. Powell was not able to check the CIs for p because the MicroFish 'Quick Population Estimate' does not report them.</p>
    </div>
    <div class="section level2">
    <h2 id="ifar-chapter">IFAR Chapter<a class="anchor" aria-label="anchor" href="#ifar-chapter"></a></h2>
    <p>10-Abundance from Depletion Data.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ogle, D.H. 2016. <a href="https://fishr-core-team.github.io/fishR/pages/books.html#introductory-fisheries-analyses-with-r" class="external-link">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Carle, F.L. and M.R. Strub. 1978. A new method for estimating population size from removal data. Biometrics, 34:621-630.</p>
<p>Cowx, I.G. 1983. Review of the methods for estimating fish population size from survey removal data. Fisheries Management, 14:67-82.</p>
<p>Moran, P.A.P. 1951. A mathematical theory of animal trapping. Biometrika 38:307-311.</p>
<p>Robson, D.S., and H.A. Regier. 1968. Estimation of population number and mortality rates. pp. 124-158 in Ricker, W.E. (editor) Methods for Assessment of Fish Production in Fresh Waters. IBP Handbook NO. 3 Blackwell Scientific Publications, Oxford.</p>
<p>Schnute, J. 1983. A new approach to estimating populations by the removal method. Canadian Journal of Fisheries and Aquatic Sciences, 40:2153-2169.</p>
<p>Seber, G.A.F. 2002. The Estimation of Animal Abundance. Edward Arnold, second edition (Reprint).</p>
<p>van Dishoeck, P. 2009. Effects of catchability variation on performance of depletion estimators: Application to an adaptive management experiment. Masters Thesis, Simon Fraser University. [Was (is?) from http://rem-main.rem.sfu.ca/theses/vanDishoeckPier_2009_MRM483.pdf.]</p>
<p>Van Deventer, J.S. 1989. Microcomputer Software System for Generating Population Statistics from Electrofishing Data--User's Guide for MicroFish 3.0. USDA Forest Service, General Technical Report INT-254. 29 p. [Was (is?) from https://relicensing.pcwa.net/documents/Library/PCWA-L<!-- %20460.pdf]. --></p>
<p>Van Deventer, J.S., and W.S. Platts. 1983. Sampling and estimating fish populations from streams. Transactions of the 48th North American Wildlife and Natural Resource Conference. pp. 349-354.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="depletion.html">depletion</a></code> for related functionality.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Derek H. Ogle, <a href="mailto:DerekOgle51@gmail.com">DerekOgle51@gmail.com</a></p>
<p>A. Powell Wheeler, <a href="mailto:powell.wheeler@gmail.com">powell.wheeler@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## First example -- 3 passes</span></span></span>
<span class="r-in"><span><span class="va">ct3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77</span>,<span class="fl">50</span>,<span class="fl">37</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Carle Strub (default) method</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 233.0000000 31.3578504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Carle &amp; Strub (1978) K-Pass Removal Method was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 233.0000000 31.3578504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No      233   31.35785</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.3313131  0.0666816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.5397426 294.4602574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.2006195   0.4620067</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI  95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.5397 294.4603</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p1</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.2006195 0.4620067</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Moran method</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span>,method<span class="op">=</span><span class="st">"Moran"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p2</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Moran (1951) K-Pass Removal Method was used (SEs not computed).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 237.5965440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3223336</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p2</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    95% LCI 95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No   194.7   370.9</span>
<span class="r-in"><span><span class="co">#'</span></span></span>
<span class="r-in"><span><span class="co"># Schnute method</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span>,method<span class="op">=</span><span class="st">"Schnute"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p3</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Schnute (1983) K-Pass Removal Method w/ Non-constant Initial Catchability was used (SEs not computed).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 245.0955550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3039927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1   0.3141632</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p3</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> An upper confidence value for 'No' cannot be determined.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    95% LCI 95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No   183.9     Inf</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Burnham method</span></span></span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct3</span>,method<span class="op">=</span><span class="st">"Burnham"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 238.0000000 33.8404319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3215686  0.0673948</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Burnham K-Pass Removal Method (Van Deventer and Platts 1983) was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 238.0000000 33.8404319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3215686  0.0673948</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No      238   33.84043</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.3215686  0.0673948</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.3335366 304.6664634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.1887992   0.4543381</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI  95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 171.3335 304.6665</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span>,parm<span class="op">=</span><span class="st">"p"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p 0.1887992 0.4543381</span>
<span class="r-in"><span><span class="co">## Second example -- 2 passes</span></span></span>
<span class="r-in"><span><span class="va">ct2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77</span>,<span class="fl">37</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Seber method</span></span></span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct2</span>,method<span class="op">=</span><span class="st">"Seber2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p4</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The Seber (2002) 2-Pass Removal Method was used.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 148.2250000 19.0118725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.5194805  0.0961208</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        95% LCI     95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 110.9624147 185.4875853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.3310873   0.7078737</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Test if catchability differs between first sample and the other samples</span></span></span>
<span class="r-in"><span><span class="co"># chi-square test statistic from  negative log-likelihoods</span></span></span>
<span class="r-in"><span><span class="co">#   from Moran and Schnute fits (from above)</span></span></span>
<span class="r-in"><span><span class="va">chi2.val</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">p2</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">-</span><span class="va">p3</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># p-value ... no significant difference</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">chi2.val</span>,df<span class="op">=</span><span class="fl">1</span>,lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8882765</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Another LRT example ... sample 1 from Schnute (1983)</span></span></span>
<span class="r-in"><span><span class="va">ct4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>,<span class="fl">11</span>,<span class="fl">18</span>,<span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2a</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct4</span>,method<span class="op">=</span><span class="st">"Moran"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3a</span> <span class="op">&lt;-</span> <span class="fu">removal</span><span class="op">(</span><span class="va">ct4</span>,method<span class="op">=</span><span class="st">"Schnute"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chi2.val</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">p2a</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">-</span><span class="va">p3a</span><span class="op">$</span><span class="va">min.nlogLH</span><span class="op">)</span>  <span class="co"># 4.74 in Schnute(1983)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">chi2.val</span>,df<span class="op">=</span><span class="fl">1</span>,lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>         <span class="co"># significant difference (catchability differs)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02955309</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">p3a</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No 123.5879686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p    0.1890032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p1   0.3641131</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Using lapply() to use removal() on many different groups</span></span></span>
<span class="r-in"><span><span class="co">###   with the removals in a single variable ("long format")</span></span></span>
<span class="r-in"><span><span class="co">## create a dummy data frame</span></span></span>
<span class="r-in"><span><span class="va">lake</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ash Tree"</span>,<span class="st">"Bark"</span>,<span class="st">"Clay"</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2010"</span>,<span class="st">"2011"</span>,<span class="st">"2010"</span>,<span class="st">"2011"</span>,<span class="st">"2010"</span>,<span class="st">"2011"</span><span class="op">)</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">catch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">57</span>,<span class="fl">34</span>,<span class="fl">65</span>,<span class="fl">34</span>,<span class="fl">12</span>,<span class="fl">54</span>,<span class="fl">26</span>,<span class="fl">9</span>,<span class="fl">54</span>,<span class="fl">27</span>,<span class="fl">67</span>,<span class="fl">34</span>,<span class="fl">68</span>,<span class="fl">35</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">lake</span>,<span class="va">year</span>,<span class="va">pass</span>,<span class="va">catch</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create a variable that indicates each different group</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">d</span>,<span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">lake</span>,<span class="va">year</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        lake year pass catch         group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  Ash Tree 2010    1    57 Ash Tree.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Ash Tree 2010    2    34 Ash Tree.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Ash Tree 2011    1    65 Ash Tree.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Ash Tree 2011    2    34 Ash Tree.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Ash Tree 2011    3    12 Ash Tree.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Bark 2010    1    54     Bark.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      Bark 2010    2    26     Bark.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Bark 2010    3     9     Bark.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      Bark 2011    1    54     Bark.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     Bark 2011    2    27     Bark.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     Clay 2010    1    67     Clay.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     Clay 2010    2    34     Clay.2010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13     Clay 2011    1    68     Clay.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14     Clay 2011    2    35     Clay.2011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15     Clay 2011    3    12     Clay.2011</span>
<span class="r-in"><span><span class="co">## split the catch by the different groups (creates a list of catch vectors)</span></span></span>
<span class="r-in"><span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">catch</span>,<span class="va">d</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## apply removal() to each catch vector (i.e., different group)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ds</span>,<span class="va">removal</span>,just.ests<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">res</span>,check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## get rownames from above and split into separate columns</span></span></span>
<span class="r-in"><span><span class="va">nms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>,<span class="st">"\\."</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">nms</span>,<span class="st">"dimnames"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="va">fnl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">nms</span>,<span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## put names together with values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fnl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fnl</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lake"</span>,<span class="st">"Year"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fnl</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Lake Year  No     No.se    No.LCI   No.UCI         p       p.se     p.LCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Ash Tree 2010 130 26.108558  78.82817 181.1718 0.4482759 0.12120594 0.2107166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Bark 2010  95  4.247687  86.67469 103.3253 0.5894040 0.06418406 0.4636055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Clay 2010 130 17.446161  95.80615 164.1938 0.5233161 0.10171976 0.3239490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Ash Tree 2011 121  5.771511 109.68805 132.3120 0.5577889 0.06016508 0.4398676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Bark 2011 103 14.760527  74.06990 131.9301 0.5328947 0.11173743 0.3138934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     Clay 2011 125  5.666291 113.89427 136.1057 0.5637255 0.05857289 0.4489247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p.UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6858351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.7152024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.7226831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6757103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.7518961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.6785262</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Using apply() to use removal() on many different groups</span></span></span>
<span class="r-in"><span><span class="co">###   with the removals in several variables ("wide format")</span></span></span>
<span class="r-in"><span><span class="co">## create a dummy data frame (just reshaped from above as</span></span></span>
<span class="r-in"><span><span class="co">## an example; -5 to ignore the group variable from above)</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html" class="external-link">reshape</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>,timevar<span class="op">=</span><span class="st">"pass"</span>,idvar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lake"</span>,<span class="st">"year"</span><span class="op">)</span>,direction<span class="op">=</span><span class="st">"wide"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## apply restore() to each row of only the catch data</span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d1</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,MARGIN<span class="op">=</span><span class="fl">1</span>,FUN<span class="op">=</span><span class="va">removal</span>,method<span class="op">=</span><span class="st">"CarleStrub"</span>,just.ests<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'NA's removed from 'catch' to continue.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'NA's removed from 'catch' to continue.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'NA's removed from 'catch' to continue.</span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">res1</span>,check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## add the grouping information to the results</span></span></span>
<span class="r-in"><span><span class="va">fnl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">d1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,<span class="va">res1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## put names together with values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fnl1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="va">fnl1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       lake year  No     No.se    No.LCI   No.UCI         p       p.se     p.LCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Ash Tree 2010 130 26.108558  78.82817 181.1718 0.4482759 0.12120594 0.2107166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Ash Tree 2011 121  5.771511 109.68805 132.3120 0.5577889 0.06016508 0.4398676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Bark 2010  95  4.247687  86.67469 103.3253 0.5894040 0.06418406 0.4636055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Bark 2011 103 14.760527  74.06990 131.9301 0.5328947 0.11173743 0.3138934</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Clay 2010 130 17.446161  95.80615 164.1938 0.5233161 0.10171976 0.3239490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     Clay 2011 125  5.666291 113.89427 136.1057 0.5637255 0.05857289 0.4489247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       p.UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6858351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6757103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.7152024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.7518961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.7226831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.6785262</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Derek Ogle, Jason Doll, Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

