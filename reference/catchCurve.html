<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mortality estimates from the descending limb of a catch curve. — catchCurve • FSA</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mortality estimates from the descending limb of a catch curve. — catchCurve"><meta name="description" content="Fits a linear model to the user-defined descending limb of a catch curve. Method functions extract estimates of the instantaneous (Z) and total annual (A) mortality rates with associated standard errors and confidence intervals. A plot method highlights the descending limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A."><meta property="og:description" content="Fits a linear model to the user-defined descending limb of a catch curve. Method functions extract estimates of the instantaneous (Z) and total annual (A) mortality rates with associated standard errors and confidence intervals. A plot method highlights the descending limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A."><meta property="og:image" content="https://fishr-core-team.github.io/FSA/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Computing_PSDs.html">Computing Proportional Size Distribution Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/Computing_Relative_Weights.html">Computing Relative Weights</a></li>
    <li><a class="dropdown-item" href="../articles/Fitting_Growth_Functions.html">Fitting Growth Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Growth_Starting_Values.html">Explaining Starting Values for Growth Functions</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html" aria-label="See package news"><span class="fa fa-newspaper"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Goto FSA home"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fishR-Core-Team/FSA" aria-label="Goto FSA github page"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Mortality estimates from the descending limb of a catch curve.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fishR-Core-Team/FSA/blob/dev/R/catchCurve.R" class="external-link"><code>R/catchCurve.R</code></a></small>
      <div class="d-none name"><code>catchCurve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a linear model to the user-defined descending limb of a catch curve. Method functions extract estimates of the instantaneous (Z) and total annual (A) mortality rates with associated standard errors and confidence intervals. A plot method highlights the descending limb, shows the linear model on the descending limb, and, optionally, prints the estimated Z and A.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">catchCurve</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">catchCurve</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">catch</span>,</span>
<span>  ages2use <span class="op">=</span> <span class="va">age</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  negWeightReplace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">catchCurve</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  ages2use <span class="op">=</span> <span class="va">age</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  negWeightReplace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'catchCurve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"all"</span>, <span class="st">"Z"</span>, <span class="st">"A"</span>, <span class="st">"lm"</span><span class="op">)</span>, as.df <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'catchCurve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">object</span>, parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"Z"</span>, <span class="st">"A"</span>, <span class="st">"lm"</span><span class="op">)</span>, as.df <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'catchCurve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'catchCurve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"both"</span>, <span class="st">"Z"</span>, <span class="st">"A"</span>, <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="va">conf.level</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  as.df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  incl.est <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'catchCurve'</span></span>
<span><span class="fu"><a href="rSquared.html">rSquared</a></span><span class="op">(</span><span class="va">object</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>, percent <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'catchCurve'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  pos.est <span class="op">=</span> <span class="st">"topright"</span>,</span>
<span>  cex.est <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  round.est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"log(Catch)"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col.pt <span class="op">=</span> <span class="st">"gray30"</span>,</span>
<span>  col.mdl <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numerical vector of assigned ages in the catch curve or a formula of the form <code>catch~age</code> when used in <code>catchCurve</code>. An object saved from <code>catchCurve</code> (i.e., of class <code>catchCurve</code>) when used in the methods.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for methods.</p></dd>


<dt id="arg-catch">catch<a class="anchor" aria-label="anchor" href="#arg-catch"></a></dt>
<dd><p>A numerical vector of catches or CPUEs for the ages in the catch curve. Not used if <code>x</code> is a formula.</p></dd>


<dt id="arg-ages-use">ages2use<a class="anchor" aria-label="anchor" href="#arg-ages-use"></a></dt>
<dd><p>A numerical vector of ages that define the descending limb of the catch curve.</p></dd>


<dt id="arg-weighted">weighted<a class="anchor" aria-label="anchor" href="#arg-weighted"></a></dt>
<dd><p>A logical that indicates whether a weighted regression should be used. See details.</p></dd>


<dt id="arg-negweightreplace">negWeightReplace<a class="anchor" aria-label="anchor" href="#arg-negweightreplace"></a></dt>
<dd><p>A single non-negative numeric that will replace negative weights (defaults to 0). Only used when <code>weighted=TRUE</code>. See details.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame from which the variables in the <code>x</code> formula can be found. Not used if <code>x</code> is not a formula.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object saved from the <code>catchCurve</code> call (i.e., of class <code>catchCurve</code>).</p></dd>


<dt id="arg-parm">parm<a class="anchor" aria-label="anchor" href="#arg-parm"></a></dt>
<dd><p>A numeric or string (of parameter names) vector that specifies which parameters are to be given confidence intervals. If <code>parm="lm"</code> then confidence intervals for the underlying linear model are returned.</p></dd>


<dt id="arg-as-df">as.df<a class="anchor" aria-label="anchor" href="#arg-as-df"></a></dt>
<dd><p>A logical that indicates whether the results of <code>coef</code>, <code>confint</code>, or <code>summary</code> should be returned as a data.frame. Ignored in <code>summary</code> if <code>parm="lm"</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Same as <code>conf.level</code>. Used for compatibility with the generic <code>confint</code> function.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>A number representing the level of confidence to use for constructing confidence intervals.</p></dd>


<dt id="arg-incl-est">incl.est<a class="anchor" aria-label="anchor" href="#arg-incl-est"></a></dt>
<dd><p>A logical that indicated whether the parameter point estimate should be included in the results from <code>confint</code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>The number of digits to round the <code>rSquared</code> result to.</p></dd>


<dt id="arg-percent">percent<a class="anchor" aria-label="anchor" href="#arg-percent"></a></dt>
<dd><p>A logical that indicates if the <code>rSquared</code> result should be returned as a percentage (<code>=TRUE</code>) or as a proportion (<code>=FALSE</code>; default).</p></dd>


<dt id="arg-pos-est">pos.est<a class="anchor" aria-label="anchor" href="#arg-pos-est"></a></dt>
<dd><p>A string to identify where to place the estimated mortality rates on the plot. Can be set to one of <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> or <code>"center"</code> for positioning the estimated mortality rates on the plot. Typically <code>"bottomleft"</code> (DEFAULT) and <code>"topright"</code> will be “out-of-the-way” placements. Set <code>pos.est</code> to <code>NULL</code> to remove the estimated mortality rates from the plot.</p></dd>


<dt id="arg-cex-est">cex.est<a class="anchor" aria-label="anchor" href="#arg-cex-est"></a></dt>
<dd><p>A single numeric character expansion value for the estimated mortality rates on the plot.</p></dd>


<dt id="arg-round-est">round.est<a class="anchor" aria-label="anchor" href="#arg-round-est"></a></dt>
<dd><p>A numeric that indicates the number of decimal place to which Z (first value) and A (second value) should be rounded. If only one value then it will be used for both Z and A.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>A label for the y-axis (<code>"log(Catch)"</code> is the default).</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>A label for the x-axis (<code>"Age"</code> is the default).</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>A numeric for the limits of the y-axis. If <code>NULL</code> then will default to a minimum of 0 or the lowest negative log catch and a maximum of the maximum log catch. If a single value then it will be the maximum of the y-axis. If two values then these will the minimum and maximum values of the y-axis.</p></dd>


<dt id="arg-col-pt">col.pt<a class="anchor" aria-label="anchor" href="#arg-col-pt"></a></dt>
<dd><p>A string that indicates the color of the plotted points.</p></dd>


<dt id="arg-col-mdl">col.mdl<a class="anchor" aria-label="anchor" href="#arg-col-mdl"></a></dt>
<dd><p>A string that indicates the color of the fitted line.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>A numeric that indicates the line width of the fitted line.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p>A numeric that indicates the type of line used for the fitted line.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list that contains the following items:</p><ul><li><p>age The original vector of assigned ages.</p></li>
<li><p>catch The original vector of observed catches or CPUEs.</p></li>
<li><p>age.e A vector of assigned ages for which the catch curve was fit.</p></li>
<li><p>log.catch.e A vector of log catches or CPUEs for which the catch curve was fit.</p></li>
<li><p>W A vector of weights used in the catch curve fit. Will be <code>NULL</code> unless <code>weighted=TRUE</code>.</p></li>
<li><p>lm An <code>lm</code> object from the fit to the ages and log catches or CPUEs on the descending limb (i.e., in age.e and log.catch.e).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The default is to use all ages in the age vector. This is appropriate only when the age and catch vectors contain only the ages and catches on the descending limb of the catch curve. Use <code>ages2use</code> to isolate only the catch and ages on the descending limb.</p>
<p>If <code>weighted=TRUE</code> then a weighted regression is used where the weights are the log(number) at each age predicted from the unweighted regression of log(number) on age (as proposed by Maceina and Bettoli (1998)). If a negative weight is computed it will be changed to the value in <code>negWeightReplace</code> and a warning will be issued.</p>
    </div>
    <div class="section level2">
    <h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h2>
    <p>Tested the results of catch curve, both unweighted and weighted, against the results in Miranda and Bettoli (2007). Results for Z and the SE of Z matched perfectly. Tested the unweighted results against the results from <code>agesurv</code> in <span class="pkg">fishmethods</span> using the <code>rockbass</code> data.frame in <span class="pkg">fishmethods</span>. Results for Z and the SE of Z matched perfectly.</p>
    </div>
    <div class="section level2">
    <h2 id="ifar-chapter">IFAR Chapter<a class="anchor" aria-label="anchor" href="#ifar-chapter"></a></h2>
    <p>11-Mortality.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ogle, D.H. 2016. <a href="https://fishr-core-team.github.io/fishR/pages/books.html#introductory-fisheries-analyses-with-r" class="external-link">Introductory Fisheries Analyses with R</a>. Chapman &amp; Hall/CRC, Boca Raton, FL.</p>
<p>Maceina, M.J., and P.W. Bettoli. 1998. Variation in Largemouth Bass recruitment in four mainstream impoundments on the Tennessee River. North American Journal of Fisheries Management 18:998-1003.</p>
<p>Ricker, W.E. 1975. Computation and interpretation of biological statistics of fish populations. Technical Report Bulletin 191, Bulletin of the Fisheries Research Board of Canada. [Was (is?) from http://www.dfo-mpo.gc.ca/Library/1485.pdf.]</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="https://rdrr.io/pkg/fishmethods/man/agesurv.html" class="external-link">agesurv</a></code> in <span class="pkg">fishmethods</span> for similar functionality. See <code><a href="chapmanRobson.html">chapmanRobson</a></code> and <code><a href="https://rdrr.io/pkg/fishmethods/man/agesurvcl.html" class="external-link">agesurvcl</a></code> in <span class="pkg">fishmethods</span> for alternative methods to estimate mortality rates. See <code><a href="metaM.html">metaM</a></code> for empirical methods to estimate natural mortality.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Derek H. Ogle, <a href="mailto:DerekOgle51@gmail.com">DerekOgle51@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catchCurve-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of formula notation</span></span></span>
<span class="r-in"><span><span class="va">cc1</span> <span class="op">&lt;-</span> <span class="fu">catchCurve</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,ages2use<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error  t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.659987   0.136741 4.826549 0.01695159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 48.314197         NA       NA         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cc1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Z         A </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.659987 48.314197 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cc1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.2248162  1.095158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 20.1337012 66.551321</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cc1</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Est    95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.659987  0.2248162  1.095158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 48.314197 20.1337012 66.551321</span>
<span class="r-in"><span><span class="fu"><a href="rSquared.html">rSquared</a></span><span class="op">(</span><span class="va">cc1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8859124</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cc1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catchCurve-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc1</span>,parm<span class="op">=</span><span class="st">"Z"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Estimate Std. Error  t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.659987   0.136741 4.826549 0.01695159</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cc1</span>,parm<span class="op">=</span><span class="st">"Z"</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Est   95% LCI  95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z 0.659987 0.2248162 1.095158</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of excluding ages2use</span></span></span>
<span class="r-in"><span><span class="va">cc2</span> <span class="op">&lt;-</span> <span class="fu">catchCurve</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,ages2use<span class="op">=</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error  t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.659987   0.136741 4.826549 0.01695159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 48.314197         NA       NA         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cc2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of using weights</span></span></span>
<span class="r-in"><span><span class="va">cc3</span> <span class="op">&lt;-</span> <span class="fu">catchCurve</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">BrookTroutTH</span>,ages2use<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>,weighted<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.6430183  0.1417433  4.5365 0.02004993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 47.4296703         NA      NA         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cc3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catchCurve-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of returning the linear model results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc3</span>,parm<span class="op">=</span><span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stats::lm(formula = log.catch.e ~ age.e, weights = W, na.action = stats::na.exclude)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Weighted Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3         4         5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.008845 -0.551857  1.155519 -0.513606 -0.103196 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   6.0086     0.5475  10.974  0.00162 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age.e        -0.6430     0.1417  -4.536  0.02005 * </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.7988 on 3 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.8728,	Adjusted R-squared:  0.8304 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 20.58 on 1 and 3 DF,  p-value: 0.02005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">cc3</span>,parm<span class="op">=</span><span class="st">"lm"</span>,incl.est<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Est   95% LCI   95% UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  6.0085938  4.266116  7.751072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age.e       -0.6430183 -1.094109 -0.191928</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of ability to work with missing age classes</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>,<span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ct<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">92</span>,<span class="fl">83</span>,<span class="fl">71</span>,<span class="fl">56</span>,<span class="fl">35</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cc4</span> <span class="op">&lt;-</span> <span class="fu">catchCurve</span><span class="op">(</span><span class="va">ct</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">df</span>,ages2use<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error  t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.5139824  0.1495532 3.436786 0.04133277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 40.1891060         NA       NA         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cc4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catchCurve-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## demonstration of ability to work with missing age classes</span></span></span>
<span class="r-in"><span><span class="co">## even if catches are recorded as NAs</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 ct<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">92</span>,<span class="fl">83</span>,<span class="fl">71</span>,<span class="cn">NA</span>,<span class="fl">56</span>,<span class="cn">NA</span>,<span class="fl">35</span>,<span class="cn">NA</span>,<span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cc5</span> <span class="op">&lt;-</span> <span class="fu">catchCurve</span><span class="op">(</span><span class="va">ct</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">df</span>,ages2use<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cc5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Estimate Std. Error  t value   Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  0.5139824  0.1495532 3.436786 0.04133277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A 40.1891060         NA       NA         NA</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cc5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="catchCurve-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Demonstration of computation for multiple groups</span></span></span>
<span class="r-in"><span><span class="co">##   only ages on the descending limb for each group are in the data.frame</span></span></span>
<span class="r-in"><span><span class="co"># Get example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FHCatfish</span>,package<span class="op">=</span><span class="st">"FSAdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">FHCatfish</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       river age abundance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Coosa   2        25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     Coosa   3        24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     Coosa   4        18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     Coosa   5        17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     Coosa   6        29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     Coosa   7        14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     Coosa   8         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8     Coosa   9        10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     Coosa  10        15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10    Coosa  11         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11    Coosa  12        11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    Coosa  13        10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    Coosa  14         5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    Coosa  15         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    Coosa  16         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    Coosa  17         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    Coosa  18         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    Coosa  20         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    Coosa  25         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Ocmulgee   2        32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 Ocmulgee   3        15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 Ocmulgee   4        13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 Ocmulgee   5         8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 Ocmulgee   6         6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 Ocmulgee   7        11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 Ocmulgee   8         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 Ocmulgee   9         8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 Ocmulgee  10         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 Ocmulgee  11         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 Ocmulgee  12         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 Ocmulgee  13         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32 Ocmulgee  16         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  Satilla   2        94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  Satilla   3        77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  Satilla   4        36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  Satilla   5         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  Satilla   6         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  Satilla   7         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  Satilla  10         1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note use of incl.est=TRUE and as.df=TRUE</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">FHCatfish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">river</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">catchCurve</span><span class="op">(</span><span class="va">abundance</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">.x</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: dplyr</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:car’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     recode</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      river         Z     Z_LCI     Z_UCI        A    A_LCI    A_UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Coosa 0.1638099 0.1226277 0.2049921 15.10966 11.54071 18.53462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Ocmulgee 0.2688858 0.1935034 0.3442682 23.57695 17.59330 29.12612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Satilla 0.6830087 0.1952544 1.1707630 49.49050 17.73746 68.98698</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Demonstration of computation for multiple groups</span></span></span>
<span class="r-in"><span><span class="co">##   ages not on descending limb are in the data.frame, but use same</span></span></span>
<span class="r-in"><span><span class="co">##     ages.use= for each group</span></span></span>
<span class="r-in"><span><span class="co"># Get example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">WalleyeKS</span>,package<span class="op">=</span><span class="st">"FSAdata"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note use of incl.est=TRUE and as.df=TRUE</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">WalleyeKS</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">reservoir</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_modify</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu">catchCurve</span><span class="op">(</span><span class="va">catch</span><span class="op">~</span><span class="va">age</span>,data<span class="op">=</span><span class="va">.x</span>,ages2use<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 incl.est<span class="op">=</span><span class="cn">TRUE</span>,as.df<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># removes tibble and grouping structure</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some 'ages2use' not in observed ages.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reservoir         Z     Z_LCI     Z_UCI        A    A_LCI    A_UCI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Cedar.Bluff 0.8109321 0.6640010 0.9578633 55.55564 48.52125 61.62881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Cheney 0.5511305 0.1738865 0.9283745 42.37021 15.96077 60.48044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Glen.Elder 0.8549700 0.5157957 1.1941443 57.47040 40.29747 69.70369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      Kirwin 0.9409243 0.4934289 1.3884198 60.97331 38.94707 75.05308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    Lovewell 0.7342132 0.4071760 1.0612505 52.01171 33.44729 65.39772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      Marion 0.6125949 0.3462704 0.8789193 45.80572 29.26788 58.47686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     Webster 0.5670799 0.1320663 1.0020935 43.28208 12.37171 63.28899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      Wilson 0.7194050 0.5551028 0.8837072 51.29580 42.59867 58.67519</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://derekogle.com" class="external-link">Derek H. Ogle</a>, Jason C. Doll, A. Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

